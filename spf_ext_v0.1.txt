# spf_ext v0.1
# External file editor
# Simon Finch
# https://github.com/spiffin/spf_ext

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjc6InNwZl9leHQiO3M6NzoidmVyc2lvbiI7czozOiIwLjEi
O3M6NjoiYXV0aG9yIjtzOjExOiJTaW1vbiBGaW5jaCI7czoxMDoiYXV0aG9yX3VyaSI7czoz
NDoiaHR0cHM6Ly9naXRodWIuY29tL3NwaWZmaW4vc3BmX2V4dCI7czoxMToiZGVzY3JpcHRp
b24iO3M6MjA6IkV4dGVybmFsIGZpbGUgZWRpdG9yIjtzOjU6Im9yZGVyIjtzOjE6IjUiO3M6
NDoidHlwZSI7czoxOiIzIjtzOjU6ImZsYWdzIjtzOjE6IjIiO3M6NDoiaGVscCI7czoyNjgw
OiJoMS4gc3BmX2V4dAoKcC4gRXh0ZXJuYWwgZmlsZSBlZGl0b3IgcGx1Z2luLiBDcmVhdGUs
IGVkaXQgYW5kIGRlbGV0ZSBleHRlcm5hbCAodG8gVGV4dHBhdHRlcm4pIGZpbGVzIGluIFRl
eHRwYXR0ZXJuIGFkbWluLgoKcC4gUkVRVUlSRVM6IFRleHBhdHRlcm4gNC40LjEgYW5kIFBI
UCA1IGFuZCBzaGVsbCBhY2Nlc3MgKGZvciBzeW0tbGlua2luZyBleGlzdGluZyBmaWxlcyku
CgpwLiAqUGxlYXNlIHJlYWQgdGhlIGluc3RydWN0aW9ucyBhbmQgbm90ZXMgYmVsb3cgYmVm
b3JlIHVzZS4qCgpwLiBUaGlzIHBsdWdpbiBjcmVhdGVzIGV4dGVybmFsIGZpbGVzIHlvdSBj
YW4gbWFuYWdlIGFuZCBlZGl0IHZpYSB0aGUgYWRtaW4gaW50ZXJmYWNlLiBBbGwgZmlsZXMg
YXJlIHNhdmVkIHRvIHRoZSBkaXJlY3RvcnkgeW91IGNyZWF0ZSBpbiBzdGVwIDEgb2YgdGhl
IGluc3RydWN0aW9ucyBiZWxvdy4gU3ludGF4IGhpZ2hsaWdodGluZyBpcyBhdmFpbGFibGUg
dmlhICJzcGZfY29kZW1pcnJvciI6aHR0cHM6Ly9naXRodWIuY29tL3NwaWZmaW4vc3BmX2Nv
ZGVtaXJyb3IgKGN1cnJlbnRseSBIVE1MLCBQSFAgYW5kIEphdmFTY3JpcHQgLSBtb3JlIHRv
IGNvbWUpLgoKCmgyLiBXaHk/CgoqIFRoaXMgcGx1Z2luIGFsbG93cyB5b3UgdG8gZWRpdCBh
bmQgbWFuYWdlIHNpdGUgZmlsZXMgcmVzaWRpbmcgb3V0c2lkZSBUZXh0cGF0dGVybiB3aXRo
aW4gdGhlIFRleHRwYXR0ZXJuIGFkbWluIGFyZWEgKHNlZSAnUHJvY2VkdXJlIGZvciBtYW5h
Z2luZyBleGlzdGluZyBmaWxlcycgYmVsb3cpLgoqIEl0IG9mZmVycyBhbiBlYXN5IHdheSB0
byBjcmVhdGUgc3RhdGljIGZpbGVzIHlvdSBjYW4gZWRpdCBhbmQgYWNjZXNzIHZpYSB5b3Vy
IHBhZ2UgdGVtcGxhdGVzOiBAPHR4cDpzaXRlX3VybCAvPmV4dF9maWxlcy95b3VyZmlsZS5o
dG1sQAoKCgpoMi4gSW5zdHJ1Y3Rpb25zOgoKIyBDcmVhdGUgYSBkaXJlY3RvcnkgZm9yIHRo
ZSBzdGF0aWMgZXh0ZXJuYWwgZmlsZXMgaW4gdGhlIHJvb3Qgb2YgeW91ciB0ZXh0cGF0dGVy
biBpbnN0YWxsYXRpb24gY2FsbGVkICdleHRfZmlsZXMnIChvciB3aGF0ZXZlciB5b3UgbGlr
ZSkuIFlvdSBzaG91bGQgbWFrZSBzdXJlIHRoYXQgUEhQIGlzIGFibGUgdG8gd3JpdGUgdG8g
dGhhdCBkaXJlY3RvcnkuCiMgVmlzaXQgdGhlIGFkdmFuY2VkIHByZWZlcmVuY2VzIGFuZCBt
YWtlIHN1cmUgdGhlICJFeHRlcm5hbCBmaWxlcyBkaXJlY3RvcnkiIHByZWZlcmVuY2UgY29u
dGFpbnMgdGhlIGRpcmVjdG9yeSB5b3UgY3JlYXRlZCBpbiBzdGVwIDEgKGJ5IGRlZmF1bHQg
J2V4dF9maWxlcycpLiBUaGlzIHBhdGggaXMgcmVsYXRpdmUgcGF0aCB0byB0aGUgZGlyZWN0
b3J5IG9mIHlvdXIgcm9vdCBUZXh0cGF0dGVybiBpbnN0YWxsYXRpb24uCiMgQWN0aXZhdGUg
dGhpcyBwbHVnaW4uCiMgR28gdG8gRXh0ZW5zaW9ucyAmZ3Q7IEV4dGVybmFsIEZpbGVzIGFu
ZCBjcmVhdGUgZmlsZXMgeW91J2QgbGlrZSB0byBtYW5hZ2UuCiMgQWx3YXlzIGluY2x1ZGUg
YSBmaWxlIGV4dGVuc2lvbiBpbiB0aGUgZmlsZSBuYW1lICguaHRtbCwgLnBocCwgZXRjLiku
CgoKCmgyLiBQcm9jZWR1cmUgZm9yIG1hbmFnaW5nIGV4aXN0aW5nIGZpbGVzOgoKIyBDb3B5
IHRoZSBjb250ZW50cyBvZiB0aGUgZmlsZSAoY2FsbGVkIGZvciBleGFtcGxlIG15ZmlsZS5w
aHApIGludG8gYSBuZXcgZmlsZSBpbiBFeHRlbnNpb25zICZndDsgRXh0ZXJuYWwgRmlsZXMg
Jmd0OyBDcmVhdGUgbmV3IGZpbGUuCiMgTmFtZSB0aGUgbmV3IGZpbGUgKEV4dGVybmFsIGZp
bGUgbmFtZTopICdteWZpbGUucGhwJy4KIyBSZW5hbWUgdGhlIG9yaWdpbmFsIGZpbGUgKHRv
LCBmb3IgZXhhbXBsZSwgJ215ZmlsZV9vcmlnaW5hbC5waHAnKSAtIHRoZW4geW91J2xsIGhh
dmUgYSBiYWNrdXAuCiMgTWFrZSBhIHN5bWJvbGljIGxpbmssIGluIHRoZSBvcmlnaW5hbCBm
aWxlIGxvY2F0aW9uLCB0byB0aGUgbmV3IGZpbGUgKGUuZy4gY2QgdG8gdGhlICdleHRfZmls
ZXMnIGRpcmVjdG9yeSBhbmQgdGhlbiAnbG4gLXMgL29yaWdpbmFsX2RpcmVjdG9yeV9wYXRo
L215ZmlsZS5waHAgLi9teWZpbGUucGhwJykuCgoKaDIuIE5vdGVzOgoKIyBZb3UgY2FuIG9u
bHkgbWFuYWdlIGZpbGVzIHdoaWNoIGFyZSByZWFkL3dyaXRlIHRvIHlvdXIgd2ViIHNlcnZl
ciAoaS5lLiB3aXRoaW4geW91ciB3ZWIgcm9vdCkgLSBlLmcuIE1pbmlmeSBjb25maWcgZmls
ZXMsIGV4dGVybmFsIHNjcmlwdHMsIGV0Yy4KIyBEZWxldGluZyBhIGZpbGUgdmlhIHRoZSBF
eHRlcm5hbCBGaWxlcyB0YWIgZGVsZXRlcyB0aGUgYWN0dWFsIGZpbGUgaW4gdGhlICdleHRf
ZmlsZXMnIGRpcmVjdG9yeSAoYXMgd2VsbCBhcyB0aGUgZGF0YWJhc2UgZW50cnkpIC0gdXNl
IHdpdGggY2FyZSEuCgoKaDIuIExhbmd1YWdlcyAoVGV4dHBhY2spCgpwLiBUaGlzIHBsdWdp
biBpbnN0YWxscyBhbiBFbmdsaXNoIFRleHRwYWNrIGJ5IGRlZmF1bHQuCgpwLiBUbyBpbnN0
YWxsIGEgVGV4dHBhY2sgZm9yIHlvdXIgb3duIGxhbmd1YWdlIHNlZSB0aGUgImluc3RydWN0
aW9ucyBvbiBHaXRIdWIiOmh0dHBzOi8vZ2l0aHViLmNvbS9zcGlmZmluL3NwZl9leHQvYmxv
Yi9tYXN0ZXIvc3BmX2V4dF90ZXh0cGFjay50eHQuCgoKCmgyLiBWZXJzaW9uIGhpc3RvcnkK
CiogMC4xIC0gQXByaWwgMjAxMiAtIGZpcnN0IHJlbGVhc2UuIjtzOjQ6ImNvZGUiO3M6ODU3
NDoiLyoqCiAqIHNwZl9leHQgLSBFeHRlcm5hbCBmaWxlIGVkaXRvciBmb3IgVGV4dHBhdHRl
cm4KICoKICogwqkgMjAxMiBTaW1vbiBGaW5jaCAtIGh0dHBzOi8vZ2l0aHViLmNvbS9zcGlm
ZmluL3NwZl9leHQKICoKICogTGljZW5zZWQgdW5kZXIgR05VIEdlbmVyYWwgUHVibGljIExp
Y2Vuc2UgdmVyc2lvbiAyCiAqIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMi4w
Lmh0bWwKICoKICogVmVyc2lvbiAwLjEgLS0gMjggQXByaWwgMjAxMgogKi8KCi8qKgogKiBT
ZXR1cCB0YWJzIGFuZCBjYWxsYmFjawogKi8KCmlmIChAdHhwaW50ZXJmYWNlID09ICdhZG1p
bicpIHsKCiAgICBhZGRfcHJpdnMoJ3NwZl9leHQnLCAnMScpOwogICAgcmVnaXN0ZXJfdGFi
KCdleHRlbnNpb25zJywgJ3NwZl9leHQnLCBnVHh0KCdzcGZfZXh0X2ZpbGVzJykpOwogICAg
cmVnaXN0ZXJfY2FsbGJhY2soJ3NwZl9leHRfZ3VpJywgJ3NwZl9leHQnKTsKICAgIHJlZ2lz
dGVyX2NhbGxiYWNrKCdzcGZfZXh0X2luc3RhbGwnLCAncGx1Z2luX2xpZmVjeWNsZS5zcGZf
ZXh0Jyk7Cgp9CgovKioKICogR1VJIGZ1bmN0aW9ucyAvIHN0ZXAgZGlzcGF0Y2hlcgogKi8K
CmZ1bmN0aW9uIHNwZl9leHRfZ3VpKCkgewoKICAgIGdsb2JhbCAkZXZlbnQsICRzdGVwOwoK
ICAgIGlmICgkZXZlbnQgPT0gJ3NwZl9leHQnKSB7CiAgICAgICAgcmVxdWlyZV9wcml2cygn
c3BmX2V4dCcpOwoKICAgICAgICBib3VuY2VyKCRzdGVwLAogICAgICAgICAgICBhcnJheSgK
ICAgICAgICAgICAgICAgICdzcGZfZXh0X2VkaXRfcmF3JyAgID0+IGZhbHNlLAogICAgICAg
ICAgICAgICAgJ3BvdXInICAgICAgICAgICAgICA9PiBmYWxzZSwKICAgICAgICAgICAgICAg
ICdzcGZfZXh0X3NhdmUnICAgICAgID0+IHRydWUsCiAgICAgICAgICAgICAgICAnc3BmX2V4
dF9jb3B5JyAgICAgICA9PiB0cnVlLAogICAgICAgICAgICAgICAgJ3NwZl9leHRfZGVsZXRl
JyAgICAgPT4gdHJ1ZSwKICAgICAgICAgICAgICAgICdzcGZfZXh0X2VkaXQnICAgICAgID0+
IGZhbHNlLAogICAgICAgICAgICApCiAgICAgICAgKTsKCiAgICAgICAgc3dpdGNoICgkc3Rl
cCkgewogICAgICAgICAgICBjYXNlICcnOiBzcGZfZXh0X2VkaXQoKTsgICAgICAgICAgICAg
ICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ3NwZl9leHRfZWRpdF9yYXcn
OiBzcGZfZXh0X2VkaXQoKTsgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ3Bv
dXInOiBzcGZfZXh0X2VkaXQoKTsgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAg
ICAgICAgY2FzZSAnc3BmX2V4dF9zYXZlJzogc3BmX2V4dF9zYXZlKCk7ICAgICAgICAgICAg
ICBicmVhazsKICAgICAgICAgICAgY2FzZSAnc3BmX2V4dF9jb3B5Jzogc3BmX2V4dF9jb3B5
KCk7ICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnc3BmX2V4dF9kZWxl
dGUnOiBzcGZfZXh0X2RlbGV0ZSgpOyAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2Fz
ZSAnc3BmX2V4dF9lZGl0Jzogc3BmX2V4dF9lZGl0KCk7CiAgICAgICAgfQogICAgfQp9Cgov
KioKICogSW5zdGFsbGVyIGZ1bmN0aW9uCiAqLwoKZnVuY3Rpb24gc3BmX2V4dF9pbnN0YWxs
KCRldmVudD0nJywgJHN0ZXA9JycpIHsKCiAgICBnbG9iYWwgJHByZWZzOwoKICAgIGlmKCRz
dGVwID09ICdkZWxldGVkJykgewoKICAgICAgICBzYWZlX2RlbGV0ZSgKICAgICAgICAgICAg
J3R4cF9wcmVmcycsCiAgICAgICAgICAgICJuYW1lPSdzcGZfZXh0X2RpciciCiAgICAgICAg
KTsKCiAgICAgICAgLy8gRG9uJ3QgZHJvcCB0aGUgdGFibGUgLSBqdXN0IGluIGNhc2UuLgog
ICAgICAgIC8vQHNhZmVfcXVlcnkoCiAgICAgICAgLy8gICAgJ0RST1AgVEFCTEUgSUYgRVhJ
U1RTICcuc2FmZV9wZngoJ3NwZl9leHQnKQogICAgICAgIC8vKTsKCiAgICAgICAgLy8gZGVs
ZXRlIHRoZSBUZXh0cGFjawoKICAgICAgICBzYWZlX2RlbGV0ZSgKICAgICAgICAgICAgJ3R4
cF9sYW5nJywKICAgICAgICAgICAgImV2ZW50ID0gJ3NwZl9leHQnIgogICAgICAgICk7Cgog
ICAgICAgIHJldHVybjsKCiAgICB9CgogICAgaWYoIWlzc2V0KCRwcmVmc1snc3BmX2V4dF9k
aXInXSkpIHsKCiAgICAgICAgc2FmZV9xdWVyeSgKICAgICAgICAgICAgIkNSRUFURSBUQUJM
RSBJRiBOT1QgRVhJU1RTICIuc2FmZV9wZngoJ3NwZl9leHQnKS4iICgKICAgICAgICAgICAg
ICAgIGZpbGVuYW1lIHZhcmNoYXIoMjU1KSBOT1QgTlVMTCBkZWZhdWx0ICcnLAogICAgICAg
ICAgICAgICAgY29udGVudCBsb25ndGV4dCBOT1QgTlVMTCwKICAgICAgICAgICAgICAgIFBS
SU1BUlkgS0VZKGZpbGVuYW1lKQogICAgICAgICAgICApIENIQVJTRVQ9dXRmOCIKICAgICAg
ICApOwoKICAgICAgICBpZighc2FmZV9jb3VudCgic3BmX2V4dCIsICJmaWxlbmFtZT0naG9s
ZGVyLnR4dCciKSkgewoKICAgICAgICAgICAgc2FmZV9pbnNlcnQoInNwZl9leHQiLCAiZmls
ZW5hbWU9J2hvbGRlci50eHQnLCBjb250ZW50PSdIb2xkZXIgdGV4dCBmaWxlLi4ueW91IG5l
ZWQgYXQgbGVhc3Qgb25lIGZpbGUgaGVyZS4nIik7CgogICAgICAgIH0KCiAgICAgICAgc2Fm
ZV9pbnNlcnQoCiAgICAgICAgICAgICd0eHBfcHJlZnMnLAogICAgICAgICAgICAicHJlZnNf
aWQ9MSwKICAgICAgICAgICAgbmFtZT0nc3BmX2V4dF9kaXInLAogICAgICAgICAgICB2YWw9
J2V4dF9maWxlcycsCiAgICAgICAgICAgIHR5cGU9MSwKICAgICAgICAgICAgZXZlbnQ9J2Fk
bWluJywKICAgICAgICAgICAgaHRtbD0ndGV4dF9pbnB1dCcsCiAgICAgICAgICAgIHBvc2l0
aW9uPTIyIgogICAgICAgICk7CiAgICB9Cn0KCi8qKgogKiBMaXN0IGZ1bmN0aW9uCiAqLwoK
ZnVuY3Rpb24gc3BmX2V4dF9saXN0KCRjdXJyZW50KSB7CgogICAgJG91dFtdID0gc3RhcnRU
YWJsZSgnbGlzdCcsICdsZWZ0Jyk7CgogICAgJHJzID0gc2FmZV9yb3dzX3N0YXJ0KCdmaWxl
bmFtZScsICdzcGZfZXh0JywgIjE9MSIpOwoKICAgIGlmICgkcnMpIHsKCiAgICAgICAgd2hp
bGUgKCRhID0gbmV4dFJvdygkcnMpKSB7CiAgICAgICAgICAgIGV4dHJhY3QoJGEpOwogICAg
ICAgICAgICAkZWRpdCA9ICgkY3VycmVudCAhPSAkZmlsZW5hbWUpID8gZUxpbmsoJ3NwZl9l
eHQnLCAnJywgJ2ZpbGVuYW1lJywgJGZpbGVuYW1lLCAkZmlsZW5hbWUpIDogaHRtbHNwZWNp
YWxjaGFycygkZmlsZW5hbWUpOwogICAgICAgICAgICAkZGVsZXRlID0gKCRmaWxlbmFtZSkg
PyBkTGluaygnc3BmX2V4dCcsICdzcGZfZXh0X2RlbGV0ZScsICdmaWxlbmFtZScsICRmaWxl
bmFtZSkgOiAnJzsKICAgICAgICAgICAgJG91dFtdID0gdHIodGQoJGVkaXQpLnRkKCRkZWxl
dGUpKTsKICAgICAgICB9CgogICAgICAgICRvdXRbXSA9ICBlbmRUYWJsZSgpOwoKICAgICAg
ICByZXR1cm4gam9pbignJywgJG91dCk7CgogICAgfQp9CgovKioKICogRWRpdCBmdW5jdGlv
bgogKi8KCmZ1bmN0aW9uIHNwZl9leHRfZWRpdCgkbWVzc2FnZT0nJykgewoKICAgIHBhZ2V0
b3AoZ1R4dCgnc3BmX2V4dF9maWxlcycpLCRtZXNzYWdlKTsKICAgIGdsb2JhbCAkc3RlcCwg
JHByZWZzOwogICAgc3BmX2V4dF9lZGl0X3JhdygpOwoKfQoKLyoqCiAqIEVkaXQgZnVuY3Rp
b24gKHJhdykKICovCgpmdW5jdGlvbiBzcGZfZXh0X2VkaXRfcmF3KCkgewoKICAgIGdsb2Jh
bCAkZXZlbnQsICRzdGVwOwoKICAgICRmaXJzdCA9IHNhZmVfcm93KCdmaWxlbmFtZScsICdz
cGZfZXh0JywgIjE9MSIpOwogICAgJGZpcnN0X2ZpbGUgPSAkZmlyc3RbJ2ZpbGVuYW1lJ107
CgogICAgZXh0cmFjdChncHNhKGFycmF5KCdmaWxlbmFtZScsICduZXduYW1lJywgJ2NvcHkn
LCAnc2F2ZW5ldycpKSk7CgogICAgaWYgKCRzdGVwID09ICdzcGZfZXh0X2RlbGV0ZScgfHwg
ZW1wdHkoJGZpbGVuYW1lKSAmJiAkc3RlcCAhPSAncG91cicgJiYgISRzYXZlbmV3KSB7Cgog
ICAgICAgICRmaWxlbmFtZSA9ICRmaXJzdF9maWxlOwoKICAgIH0KCiAgICBlbHNlaWYgKCgk
Y29weSB8fCAkc2F2ZW5ldykgJiYgdHJpbShwcmVnX3JlcGxhY2UoJy9bPD4mIlwnXS8nLCAn
JywgJG5ld25hbWUpKSkgewoKICAgICAgICAkZmlsZW5hbWUgPSAkbmV3bmFtZTsKCiAgICB9
CgogICAgaWYgKGVtcHR5KCRmaWxlbmFtZSkpIHsKCiAgICAgICAgJGJ1dHRvbnMgPSAnPGRp
diBjbGFzcz0iZWRpdC10aXRsZSI+Jy4KICAgICAgICBnVHh0KCdzcGZfZmlsZV9uYW1lJyku
JzogJwogICAgICAgIC5mSW5wdXQoJ3RleHQnLCduZXduYW1lJywnJywnZWRpdCcsJycsJycs
MjApLgogICAgICAgIGhJbnB1dCgnc2F2ZW5ldycsJ3NhdmVuZXcnKS4KICAgICAgICAnPC9k
aXY+JzsKICAgICAgICAkZmlsZWNvbnRlbnQgPSBncHMoJ3NwZl9leHQnKTsKCiAgICB9IGVs
c2UgewoKICAgICAgICAkYnV0dG9ucyA9ICc8ZGl2IGNsYXNzPSJlZGl0LXRpdGxlIj4nLmdU
eHQoJ3NwZl9lZGl0X3NjcmlwdCcpLnNwLnN0cm9uZyhodG1sc3BlY2lhbGNoYXJzKCRmaWxl
bmFtZSkpLic8L2Rpdj4nOwogICAgICAgICRmaWxlY29udGVudCA9IGZldGNoKCJjb250ZW50
Iiwnc3BmX2V4dCcsJ2ZpbGVuYW1lJywkZmlsZW5hbWUpOwoKICAgIH0KCiAgICBpZiAoIWVt
cHR5KCRmaWxlbmFtZSkpIHsKCiAgICAgICAgJGNvcHkgPSAnPHNwYW4gY2xhc3M9ImNvcHkt
YXMiPjxsYWJlbCBmb3I9ImNvcHktZmlsZSI+Jy5nVHh0KCdzcGZfY29weV9maWxlJykuJzwv
bGFiZWw+Jy5zcC5mSW5wdXQoJ3RleHQnLCAnbmV3bmFtZScsICcnLCAnZWRpdCcsICcnLCAn
JywgJycsICcnLCAnY29weS1maWxlJykuc3AuCiAgICAgICAgICAgIGZJbnB1dCgnc3VibWl0
JywgJ2NvcHknLCBnVHh0KCdjb3B5JyksICdzbWFsbGVyYm94JykuJzwvc3Bhbj4nOwoKICAg
IH0gZWxzZSB7CgogICAgICAgICRjb3B5ID0gJyc7CgogICAgfQoKICAgICRyaWdodCA9CiAg
ICAnPGRpdiBpZD0iY29udGVudF9zd2l0Y2hlciI+Jy4KICAgIGhlZChnVHh0KCdzcGZfYWxs
X2ZpbGVzJyksMikuCiAgICBncmFmKHNMaW5rKCdzcGZfZXh0JywgJ3BvdXInLCBnVHh0KCdz
cGZfY3JlYXRlX25ld19maWxlJykpLCAnIGNsYXNzPSJhY3Rpb24tY3JlYXRlIHNtYWxsZXJi
b3giJykuCiAgICBzcGZfZXh0X2xpc3QoJGZpbGVuYW1lKS4KICAgICc8L2Rpdj4nOwoKICAg
IGVjaG8KICAgICc8ZGl2IGlkPSInLiRldmVudC4nX2NvbnRhaW5lciIgY2xhc3M9InR4cC1j
b250YWluZXIgdHhwLWVkaXQiPicuCiAgICBzdGFydFRhYmxlKCdlZGl0JykuCiAgICB0cigK
ICAgICAgICB0ZCgKICAgICAgICAgICAgZm9ybSgKICAgICAgICAgICAgICAgICc8ZGl2IGlk
PSJtYWluX2NvbnRlbnQiPicuCiAgICAgICAgICAgICAgICAkYnV0dG9ucy4KICAgICAgICAg
ICAgICAgICc8dGV4dGFyZWEgaWQ9InNwZl9leHQiIGNsYXNzPSJjb2RlIiBuYW1lPSJzcGZf
ZXh0IiBjb2xzPSI3OCIgcm93cz0iMzIiIHN0eWxlPSJtYXJnaW4tdG9wOiA2cHg7IHdpZHRo
OiA3MDBweDsgaGVpZ2h0OiA1MTVweDsiPicuaHRtbHNwZWNpYWxjaGFycygkZmlsZWNvbnRl
bnQpLic8L3RleHRhcmVhPicuYnIuCiAgICAgICAgICAgICAgICBmSW5wdXQoJ3N1Ym1pdCcs
JycsZ1R4dCgnc2F2ZScpLCdwdWJsaXNoJykuCiAgICAgICAgICAgICAgICBlSW5wdXQoJ3Nw
Zl9leHQnKS5zSW5wdXQoJ3NwZl9leHRfc2F2ZScpLgogICAgICAgICAgICAgICAgaElucHV0
KCdmaWxlbmFtZScsJGZpbGVuYW1lKQogICAgICAgICAgICAgICAgLiRjb3B5LgogICAgICAg
ICAgICAgICAgJzwvZGl2PicKICAgICAgICAgICAgLCAnJywgJycsICdwb3N0JywgJ2VkaXQt
Zm9ybScsICcnLCAnc3R5bGVfZm9ybScpCiAgICAgICAgLCAnJywgJ2NvbHVtbicpLgogICAg
ICAgIHRkdGwoCiAgICAgICAgICAgICRyaWdodAogICAgICAgICwgJyBjbGFzcz0iY29sdW1u
IicpCiAgICApLgogICAgZW5kVGFibGUoKS4KICAgICc8L2Rpdj4nOwp9CgovKioKICogQ29w
eSBmdW5jdGlvbgogKgogKi8KCmZ1bmN0aW9uIHNwZl9leHRfY29weSgpIHsKCiAgICBleHRy
YWN0KGdwc2EoYXJyYXkoJ29sZG5hbWUnLCAnbmV3bmFtZScpKSk7CgogICAgJGNvbnRlbnQg
PSBkb1NsYXNoKGZldGNoKCdjb250ZW50JywgJ3NwZl9leHQnLCAnZmlsZW5hbWUnLCAkb2xk
bmFtZSkpOwoKICAgICRycyA9IHNhZmVfaW5zZXJ0KCdzcGZfZXh0JywgImNvbnRlbnQgPSAn
JGNvbnRlbnQnLCBmaWxlbmFtZSA9ICciLmRvU2xhc2goJG5ld25hbWUpLiInIik7CgogICAg
c3BmX2V4dF9lZGl0KAogICAgICAgIGdUeHQoJ3NwZl9maWxlX2NyZWF0ZWQnLCBhcnJheSgn
e25hbWV9JyA9PiAkbmV3bmFtZSkpCiAgICApOwp9CgovKioKICogU2F2ZSBmdW5jdGlvbgog
Ki8KCmZ1bmN0aW9uIHNwZl9leHRfc2F2ZSgpIHsKCiAgICBleHRyYWN0KGdwc2EoYXJyYXko
J2ZpbGVuYW1lJywnc3BmX2V4dCcsJ3NhdmVuZXcnLCduZXduYW1lJywnY29weScpKSk7CiAg
ICAkY29udGVudCA9IGRvU2xhc2goJHNwZl9leHQpOwoKICAgIGlmICgkc2F2ZW5ldyBvciAk
Y29weSkgewoKICAgICAgICAkbmV3bmFtZSA9IGRvU2xhc2godHJpbShwcmVnX3JlcGxhY2Uo
Jy9bPD4mIlwnXS8nLCAnJywgZ3BzKCduZXduYW1lJykpKSk7CgogICAgICAgIGlmICgkbmV3
bmFtZSBhbmQgc2FmZV9maWVsZCgnZmlsZW5hbWUnLCAnc3BmX2V4dCcsICJmaWxlbmFtZSA9
ICckbmV3bmFtZSciKSkgewoKICAgICAgICAgICAgJG1lc3NhZ2UgPSBnVHh0KCdzcGZfZmls
ZV9leGlzdHMnLCBhcnJheSgne25hbWV9JyA9PiAkbmV3bmFtZSkpOwoKICAgICAgICAgICAg
aWYgKCRzYXZlbmV3KSB7CgogICAgICAgICAgICAgICAgJF9QT1NUWyduZXduYW1lJ10gPSAn
JzsKCiAgICAgICAgICAgIH0KCiAgICAgICAgfSBlbHNlaWYgKCRuZXduYW1lKSB7CgogICAg
ICAgICAgICBzYWZlX2luc2VydCgnc3BmX2V4dCcsICJmaWxlbmFtZSA9ICciLiRuZXduYW1l
LiInLCBjb250ZW50ID0gJyRjb250ZW50JyIpOwoKICAgICAgICAgICAgJG1lc3NhZ2UgPSBn
VHh0KCdzcGZfZmlsZV9jcmVhdGVkJywgYXJyYXkoJ3tuYW1lfScgPT4gJG5ld25hbWUpKTsK
CiAgICAgICAgICAgIHNwZl9leHRfd3JpdGUoKTsKCiAgICAgICAgfSBlbHNlIHsKCiAgICAg
ICAgICAgICRtZXNzYWdlID0gYXJyYXkoZ1R4dCgnc3BmX2ZpbGVfbmFtZV9yZXF1aXJlZCcp
LCBFX0VSUk9SKTsKCiAgICAgICAgfQoKICAgICAgICBzcGZfZXh0X2VkaXQoJG1lc3NhZ2Up
OwoKICAgIH0gZWxzZSB7CgogICAgICAgIHNhZmVfdXBkYXRlKCdzcGZfZXh0JywgImNvbnRl
bnQgPSAnJGNvbnRlbnQnIiwgImZpbGVuYW1lID0gJyIuZG9TbGFzaCgkZmlsZW5hbWUpLiIn
Iik7CgogICAgICAgICRtZXNzYWdlID0gZ1R4dCgnc3BmX2ZpbGVfdXBkYXRlZCcsIGFycmF5
KCd7bmFtZX0nID0+ICRmaWxlbmFtZSkpOwoKICAgICAgICBzcGZfZXh0X3dyaXRlKCk7Cgog
ICAgICAgIHNwZl9leHRfZWRpdCgkbWVzc2FnZSk7CgogICAgfQoKfQoKLyoqCiAqIFdyaXRl
IGZ1bmN0aW9uCiAqLwoKZnVuY3Rpb24gc3BmX2V4dF93cml0ZSgpIHsKCiAgICBnbG9iYWwg
JHByZWZzOwogICAgZXh0cmFjdChncHNhKGFycmF5KCdmaWxlbmFtZScsJ3NwZl9leHQnLCdz
YXZlbmV3JywnbmV3bmFtZScsJ2NvcHknKSkpOwoKICAgICRmaWxlbmFtZSA9IChwcygnY29w
eScpIG9yIHBzKCdzYXZlbmV3JykpID8gcHMoJ25ld25hbWUnKSA6IHBzKCdmaWxlbmFtZScp
OwogICAgJGZpbGUgPSAkcHJlZnNbJ3BhdGhfdG9fc2l0ZSddLicvJy4kcHJlZnNbJ3NwZl9l
eHRfZGlyJ10uJy8nLiRmaWxlbmFtZTsKCiAgICBpZiAoZW1wdHkoJHByZWZzWydzcGZfZXh0
X2RpciddKSBvciAhJGZpbGVuYW1lKSB7CgogICAgICAgIHJldHVybjsKCiAgICB9IGVsc2Ug
ewoKICAgICRjb250ZW50X3JhdyA9IGZldGNoKCJjb250ZW50IiwgInNwZl9leHQiLCAnZmls
ZW5hbWUnLCAkZmlsZW5hbWUpOyAvLyBNb3ZlZCBoZXJlIHRvIHNhdmUgbmV3bHktY3JlYXRl
ZCBmaWxlcwoKICAgICAgICAkaGFuZGxlID0gZm9wZW4oJGZpbGUsICd3YicpOwogICAgICAg
IGZ3cml0ZSgkaGFuZGxlLCAkY29udGVudF9yYXcpOwogICAgICAgIGZjbG9zZSgkaGFuZGxl
KTsKICAgICAgICBjaG1vZCgkZmlsZSwgMDY0NCk7CiAgICB9Cgp9CgovKioKICogRGVsZXRl
IGZ1bmN0aW9uCiAqLwoKZnVuY3Rpb24gc3BmX2V4dF9kZWxldGUoKSB7CgogICAgZ2xvYmFs
ICRwcmVmczsKCiAgICAkZmlsZW5hbWUgPSBwcygnZmlsZW5hbWUnKTsKICAgICRmaWxlID0g
JHByZWZzWydwYXRoX3RvX3NpdGUnXS4nLycuJHByZWZzWydzcGZfZXh0X2RpciddLicvJy4k
ZmlsZW5hbWU7CgogICAgICAgIGlmICghZW1wdHkoJHByZWZzWydzcGZfZXh0X2RpciddKSBh
bmQgJGZpbGVuYW1lKSB7CgogICAgICAgICAgICBzYWZlX2RlbGV0ZSgnc3BmX2V4dCcsICJm
aWxlbmFtZSA9ICciLmRvU2xhc2goJGZpbGVuYW1lKS4iJyIpOwoKICAgICAgICAgICAgQHVu
bGluaygkZmlsZSk7CgogICAgICAgIHNwZl9leHRfZWRpdCgKCiAgICAgICAgICAgIGdUeHQo
J3NwZl9maWxlX2RlbGV0ZWQnLCBhcnJheSgne25hbWV9JyA9PiAkZmlsZW5hbWUpKQogICAg
ICAgICk7CgogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm47CiAgICB9Cgp9IjtzOjM6Im1k
NSI7czozMjoiOWQ1ZDZhMDFiNTYzMjIyNTgzZDRjNzA5MTkyYTEzNTYiO30=
