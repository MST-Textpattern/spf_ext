# spf_ext v0.1
# External file editor
# Simon Finch
# https://github.com/spiffin/spf_ext

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMjp7czo0OiJuYW1lIjtzOjc6InNwZl9leHQiO3M6NzoidmVyc2lvbiI7czozOiIwLjEi
O3M6NjoiYXV0aG9yIjtzOjExOiJTaW1vbiBGaW5jaCI7czoxMDoiYXV0aG9yX3VyaSI7czoz
NDoiaHR0cHM6Ly9naXRodWIuY29tL3NwaWZmaW4vc3BmX2V4dCI7czoxMToiZGVzY3JpcHRp
b24iO3M6MjA6IkV4dGVybmFsIGZpbGUgZWRpdG9yIjtzOjU6Im9yZGVyIjtzOjE6IjUiO3M6
NDoidHlwZSI7czoxOiIzIjtzOjU6ImZsYWdzIjtzOjE6IjIiO3M6ODoidGV4dHBhY2siO3M6
NTg3OiIjQHNwZl9leHQKc3BmX2V4dF9maWxlcyA9PiBFeHRlcm5hbCBGaWxlcwpzcGZfZXh0
X2RpciA9PiBFeHRlcm5hbCBmaWxlcyBkaXJlY3RvcnkKc3BmX2ZpbGVuYW1lID0+IEZpbGVu
YW1lCnNwZl9lZGl0X2ZpbGUgPT4gWW91IGFyZSBlZGl0aW5nIGZpbGUKc3BmX2FsbF9maWxl
cyA9PiBBbGwgRmlsZXMKc3BmX2ZpbGVfdXBkYXRlZCA9PiBGaWxlIDxzdHJvbmc+e25hbWV9
PC9zdHJvbmc+IHVwZGF0ZWQuCnNwZl9maWxlX25hbWUgPT4gRXh0ZXJuYWwgZmlsZSBuYW1l
CnNwZl9jb3B5X2ZpbGUgPT4gJiM4MjMwO29yIGNvcHkgZmlsZSBhcwpzcGZfY3JlYXRlX25l
d19maWxlID0+IENyZWF0ZSBuZXcgZmlsZQpzcGZfZmlsZV9jcmVhdGVkID0+IEZpbGUgPHN0
cm9uZz57bmFtZX08L3N0cm9uZz4gY3JlYXRlZC4Kc3BmX2ZpbGVfbmFtZV9yZXF1aXJlZCA9
PiBQbGVhc2UgcHJvdmlkZSBhIG5hbWUgZm9yIHlvdXIgZmlsZS4Kc3BmX2ZpbGVfZXhpc3Rz
ID0+IEZpbGUgPHN0cm9uZz57bmFtZX08L3N0cm9uZz4gYWxyZWFkeSBleGlzdHMuCnNwZl9m
aWxlX2RlbGV0ZWQgPT4gRmlsZSA8c3Ryb25nPntuYW1lfTwvc3Ryb25nPiBkZWxldGVkLiI7
czo0OiJoZWxwIjtzOjMyNzA6IjxoMT5FeHRlcm5hbCBmaWxlIGVkaXRvcjwvaDE+Cgo8cD5D
cmVhdGUsIGVkaXQgYW5kIGRlbGV0ZSBleHRlcm5hbCAodG8gVGV4dHBhdHRlcm4pIGZpbGVz
IGluIFRleHRwYXR0ZXJuIGFkbWluLjwvcD4KCjxwPlJFUVVJUkVTOiBUZXhwYXR0ZXJuIDQu
NC4xIGFuZCBQSFAgNSBhbmQgc2hlbGwgYWNjZXNzIChmb3Igc3ltLWxpbmtpbmcgZXhpc3Rp
bmcgZmlsZXMpLjwvcD4KCjxwPjxzdHJvbmc+UGxlYXNlIHJlYWQgdGhlIGluc3RydWN0aW9u
cyBhbmQgbm90ZXMgYmVsb3cgYmVmb3JlIHVzZS48L3N0cm9uZz48L3A+Cgo8cD5MYXRlc3Qg
dmVyc2lvbjogPGEgaHJlZj0iaHR0cHM6Ly9naXRodWIuY29tL3NwaWZmaW4vc3BmX2V4dCI+
c3BmX2V4dCBHaXRIdWIgcmVwb3NpdG9yeTwvYT4uPC9wPgoKPHA+VGhpcyBwbHVnaW4gY3Jl
YXRlcyBleHRlcm5hbCBmaWxlcyB5b3UgY2FuIG1hbmFnZSBhbmQgZWRpdCB2aWEgdGhlIGFk
bWluIGludGVyZmFjZS4gQWxsIGZpbGVzIGFyZSBzYXZlZCB0byB0aGUgZGlyZWN0b3J5IHlv
dSBjcmVhdGUgaW4gc3RlcCAxIG9mIHRoZSBpbnN0cnVjdGlvbnMgYmVsb3cuIFN5bnRheCBo
aWdobGlnaHRpbmcgaXMgYXZhaWxhYmxlIHZpYSB0aGUgPGEgaHJlZj0iaHR0cHM6Ly9naXRo
dWIuY29tL3NwaWZmaW4vQ29kZU1pcnJvclRleHRwYXR0ZXJuIj5Db2RlbWlycm9yIGFkbWlu
IHRoZW1lPC9hPiAoY3VycmVudGx5IEhUTUwsIFBIUCBhbmQgSmF2YVNjcmlwdCAtIG1vcmUg
dG8gY29tZSkuPC9wPgoKPGJyIC8+CjxociAvPgo8YnIgLz4KCjxoMz5XaHk/PC9oMz4KCjx1
bD4KCjxsaT5UaGlzIHBsdWdpbiBhbGxvd3MgeW91IHRvIGVkaXQgYW5kIG1hbmFnZSBzaXRl
IGZpbGVzIHJlc2lkaW5nIG91dHNpZGUgVGV4dHBhdHRlcm4gd2l0aGluIHRoZSBUZXh0cGF0
dGVybiBhZG1pbiBhcmVhIChzZWUgJ1Byb2NlZHVyZSBmb3IgbWFuYWdpbmcgZXhpc3Rpbmcg
ZmlsZXMnIGJlbG93KS48L2xpPgoKPGxpPkl0IG9mZmVycyBhbiBlYXN5IHdheSB0byBjcmVh
dGUgc3RhdGljIGZpbGVzIHlvdSBjYW4gZWRpdCBhbmQgYWNjZXNzIHZpYSB5b3VyIHBhZ2Ug
dGVtcGxhdGVzOiA8Y29kZT4mbHQ7dHhwOnNpdGVfdXJsIC8mZ3Q7ZXh0X2ZpbGVzL3lvdXJm
aWxlLmh0bWw8L2NvZGU+PC9saT4KCjwvdWw+Cgo8YnIgLz4KPGhyIC8+CjxiciAvPgoKCTxo
Mz5JbnN0cnVjdGlvbnM6PC9oMz4KCTxvbD4KCQk8bGk+Q3JlYXRlIGEgZGlyZWN0b3J5IGZv
ciB0aGUgc3RhdGljIGV4dGVybmFsIGZpbGVzIGluIHRoZSByb290IG9mIHlvdXIgdGV4dHBh
dHRlcm4gaW5zdGFsbGF0aW9uIGNhbGxlZCAnZXh0X2ZpbGVzJyAob3Igd2hhdGV2ZXIgeW91
IGxpa2UpLiBZb3Ugc2hvdWxkIG1ha2Ugc3VyZSB0aGF0IFBIUCBpcyBhYmxlIHRvIHdyaXRl
IHRvIHRoYXQgZGlyZWN0b3J5LjwvbGk+CgkJPGxpPlZpc2l0IHRoZSA8YSBocmVmPSJpbmRl
eC5waHA/ZXZlbnQ9cHJlZnMmYW1wO3N0ZXA9YWR2YW5jZWRfcHJlZnMiPmFkdmFuY2VkIHBy
ZWZlcmVuY2VzPC9hPiBhbmQgbWFrZSBzdXJlIHRoZSAmIzgyMjA7RXh0ZXJuYWwgZmlsZXMg
ZGlyZWN0b3J5JiM4MjIxOyBwcmVmZXJlbmNlIGNvbnRhaW5zIHRoZSBkaXJlY3RvcnkgeW91
IGNyZWF0ZWQgaW4gc3RlcCAxIChieSBkZWZhdWx0ICdleHRfZmlsZXMnKS4gVGhpcyBwYXRo
IGlzIHJlbGF0aXZlIHBhdGggdG8gdGhlIGRpcmVjdG9yeSBvZiB5b3VyIHJvb3QgVGV4dHBh
dHRlcm4gaW5zdGFsbGF0aW9uLjwvbGk+CgkJPGxpPkFjdGl2YXRlIHRoaXMgcGx1Z2luLjwv
bGk+CgkJPGxpPkdvIHRvIEV4dGVuc2lvbnMgPiBFeHRlcm5hbCBGaWxlcyBhbmQgY3JlYXRl
IGZpbGVzIHlvdSdkIGxpa2UgdG8gbWFuYWdlLjwvbGk+CgkJPGxpPkFsd2F5cyBpbmNsdWRl
IGEgZmlsZSBleHRlbnNpb24gaW4gdGhlIGZpbGUgbmFtZSAoLmh0bWwsIC5waHAsIGV0Yy4p
LjwvbGk+Cgk8L29sPgoKPGJyIC8+CjxociAvPgo8YnIgLz4KCgk8aDM+UHJvY2VkdXJlIGZv
ciBtYW5hZ2luZyBleGlzdGluZyBmaWxlczo8L2gzPgoJPG9sPgoJCTxsaT5Db3B5IHRoZSBj
b250ZW50cyBvZiB0aGUgZmlsZSAoY2FsbGVkIGZvciBleGFtcGxlIG15ZmlsZS5waHApIGlu
dG8gYSBuZXcgZmlsZSBpbiBFeHRlbnNpb25zID4gRXh0ZXJuYWwgRmlsZXMgPiBDcmVhdGUg
bmV3IGZpbGUuPC9saT4KCQk8bGk+TmFtZSB0aGUgbmV3IGZpbGUgKEV4dGVybmFsIGZpbGUg
bmFtZTopICdteWZpbGUucGhwJy48L2xpPgoJCTxsaT5SZW5hbWUgdGhlIG9yaWdpbmFsIGZp
bGUgKHRvLCBmb3IgZXhhbXBsZSwgJ215ZmlsZV9vcmlnaW5hbC5waHAnKSAtIHRoZW4geW91
J2xsIGhhdmUgYSBiYWNrdXAuPC9saT4KCQk8bGk+TWFrZSBhIHN5bWJvbGljIGxpbmssIGlu
IHRoZSBvcmlnaW5hbCBmaWxlIGxvY2F0aW9uLCB0byB0aGUgbmV3IGZpbGUgKGUuZy4gY2Qg
dG8gdGhlICdleHRfZmlsZXMnIGRpcmVjdG9yeSBhbmQgdGhlbiAnbG4gLXMgL29yaWdpbmFs
X2RpcmVjdG9yeV9wYXRoL215ZmlsZS5waHAgLi9teWZpbGUucGhwJykuPC9saT4KCTwvb2w+
Cgo8YnIgLz4KPGhyIC8+CjxiciAvPgoKCTxoMz5Ob3Rlczo8L2gzPgogICAgICAgIDxvbD4K
ICAgICAgICA8bGk+WW91IGNhbiBvbmx5IG1hbmFnZSBmaWxlcyB3aGljaCBhcmUgcmVhZC93
cml0ZSB0byB5b3VyIHdlYiBzZXJ2ZXIgKGkuZS4gd2l0aGluIHlvdXIgd2ViIHJvb3QpIC0g
ZS5nLiBNaW5pZnkgY29uZmlnIGZpbGVzLCBleHRlcm5hbCBzY3JpcHRzPC9saT4KCiAgICAg
ICAgPGxpPkRlbGV0aW5nIGEgZmlsZSB2aWEgdGhlIEV4dGVybmFsIEZpbGVzIHRhYiBkZWxl
dGVzIHRoZSBhY3R1YWwgZmlsZSAoYXMgd2VsbCBhcyB0aGUgZGF0YWJhc2UgZW50cnkpIC0g
dXNlIHdpdGggY2FyZSEuPC9wPgogICAgICAgIDwvb2w+Cgo8YnIgLz4KPGhyIC8+CjxiciAv
PgoKICAgICAgICA8aDM+TGFuZ3VhZ2VzIChUZXh0cGFjayk8L2gzPgoKICAgICAgICA8cD5U
aGlzIHBsdWdpbiBpbnN0YWxscyBhbiBFbmdsaXNoIFRleHRwYWNrIGJ5IGRlZmF1bHQuPC9w
PgogICAgICAgIDxwPlRvIGluc3RhbGwgYSBUZXh0cGFjayBmb3IgeW91ciBvd24gbGFuZ3Vh
Z2Ugc2VlIHRoZSA8YSBocmVmPSJodHRwczovL2dpdGh1Yi5jb20vc3BpZmZpbi9zcGZfZXh0
L2Jsb2IvbWFzdGVyL3NwZl9leHRfdGV4dHBhY2sudHh0Ij5pbnN0cnVjdGlvbnMgb24gR2l0
SHViPC9hPi48L3A+Cgo8YnIgLz4KPGhyIC8+CjxiciAvPgoKICAgICAgICA8aDM+VmVyc2lv
biBoaXN0b3J5PC9oMz4KCjAuMSAtIEFwcmlsIDIwMTIgLSBmaXJzdCByZWxlYXNlLiI7czo0
OiJjb2RlIjtzOjg1MzM6Ii8qKgogKiBzcGZfZXh0IC0gRXh0ZXJuYWwgZmlsZSBlZGl0b3Ig
Zm9yIFRleHRwYXR0ZXJuCiAqCiAqIMKpIDIwMTIgU2ltb24gRmluY2ggLSBodHRwczovL2dp
dGh1Yi5jb20vc3BpZmZpbi9zcGZfZXh0CiAqCiAqIExpY2Vuc2VkIHVuZGVyIEdOVSBHZW5l
cmFsIFB1YmxpYyBMaWNlbnNlIHZlcnNpb24gMgogKiBodHRwOi8vd3d3LmdudS5vcmcvbGlj
ZW5zZXMvZ3BsLTIuMC5odG1sCiAqCiAqIFZlcnNpb24gMC4xIC0tIDI4IEFwcmlsIDIwMTIK
ICovCgovKioKICogU2V0dXAgdGFicyBhbmQgY2FsbGJhY2sKICovCgppZiAoQHR4cGludGVy
ZmFjZSA9PSAnYWRtaW4nKSB7CgogICAgYWRkX3ByaXZzKCdzcGZfZXh0JywgJzEnKTsKICAg
IHJlZ2lzdGVyX3RhYignZXh0ZW5zaW9ucycsICdzcGZfZXh0JywgZ1R4dCgnc3BmX2V4dF9m
aWxlcycpKTsKICAgIHJlZ2lzdGVyX2NhbGxiYWNrKCdzcGZfZXh0X2d1aScsICdzcGZfZXh0
Jyk7CiAgICByZWdpc3Rlcl9jYWxsYmFjaygnc3BmX2V4dF9pbnN0YWxsJywgJ3BsdWdpbl9s
aWZlY3ljbGUuc3BmX2V4dCcpOwoKfQoKLyoqCiAqIEdVSSBmdW5jdGlvbnMgLyBzdGVwIGRp
c3BhdGNoZXIKICovCgpmdW5jdGlvbiBzcGZfZXh0X2d1aSgpIHsKCiAgICBnbG9iYWwgJGV2
ZW50LCAkc3RlcDsKCiAgICBpZiAoJGV2ZW50ID09ICdzcGZfZXh0JykgewogICAgICAgIHJl
cXVpcmVfcHJpdnMoJ3NwZl9leHQnKTsKCiAgICAgICAgYm91bmNlcigkc3RlcCwKICAgICAg
ICAgICAgYXJyYXkoCiAgICAgICAgICAgICAgICAnc3BmX2V4dF9lZGl0X3JhdycgICA9PiBm
YWxzZSwKICAgICAgICAgICAgICAgICdwb3VyJyAgICAgICAgICAgICAgPT4gZmFsc2UsCiAg
ICAgICAgICAgICAgICAnc3BmX2V4dF9zYXZlJyAgICAgICA9PiB0cnVlLAogICAgICAgICAg
ICAgICAgJ3NwZl9leHRfY29weScgICAgICAgPT4gdHJ1ZSwKICAgICAgICAgICAgICAgICdz
cGZfZXh0X2RlbGV0ZScgICAgID0+IHRydWUsCiAgICAgICAgICAgICAgICAnc3BmX2V4dF9l
ZGl0JyAgICAgICA9PiBmYWxzZSwKICAgICAgICAgICAgKQogICAgICAgICk7CgogICAgICAg
IHN3aXRjaCAoJHN0ZXApIHsKICAgICAgICAgICAgY2FzZSAnJzogc3BmX2V4dF9lZGl0KCk7
ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICdzcGZf
ZXh0X2VkaXRfcmF3Jzogc3BmX2V4dF9lZGl0KCk7ICAgICAgICAgIGJyZWFrOwogICAgICAg
ICAgICBjYXNlICdwb3VyJzogc3BmX2V4dF9lZGl0KCk7ICAgICAgICAgICAgICAgICAgICAg
YnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ3NwZl9leHRfc2F2ZSc6IHNwZl9leHRfc2F2ZSgp
OyAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ3NwZl9leHRfY29weSc6
IHNwZl9leHRfY29weSgpOyAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2Ug
J3NwZl9leHRfZGVsZXRlJzogc3BmX2V4dF9kZWxldGUoKTsgICAgICAgICAgYnJlYWs7CiAg
ICAgICAgICAgIGNhc2UgJ3NwZl9leHRfZWRpdCc6IHNwZl9leHRfZWRpdCgpOwogICAgICAg
IH0KICAgIH0KfQoKLyoqCiAqIEluc3RhbGxlciBmdW5jdGlvbgogKi8KCmZ1bmN0aW9uIHNw
Zl9leHRfaW5zdGFsbCgkZXZlbnQ9JycsICRzdGVwPScnKSB7CgogICAgZ2xvYmFsICRwcmVm
czsKCiAgICBpZigkc3RlcCA9PSAnZGVsZXRlZCcpIHsKCiAgICAgICAgc2FmZV9kZWxldGUo
CiAgICAgICAgICAgICd0eHBfcHJlZnMnLAogICAgICAgICAgICAibmFtZT0nc3BmX2pzX2Rp
ciciCiAgICAgICAgKTsKCiAgICAgICAgLy8gRG9uJ3QgZHJvcCB0aGUgdGFibGUgLSBqdXN0
IGluIGNhc2UuLgogICAgICAgIC8vQHNhZmVfcXVlcnkoCiAgICAgICAgLy8gICAgJ0RST1Ag
VEFCTEUgSUYgRVhJU1RTICcuc2FmZV9wZngoJ3NwZl9qcycpCiAgICAgICAgLy8pOwoKICAg
ICAgICAvLyBkZWxldGUgdGhlIFRleHRwYWNrCgogICAgICAgIHNhZmVfZGVsZXRlKAogICAg
ICAgICAgICAndHhwX2xhbmcnLAogICAgICAgICAgICAiZXZlbnQgPSAnc3BmX2pzJyIKICAg
ICAgICApOwoKICAgICAgICByZXR1cm47CgogICAgfQoKICAgIGlmKCFpc3NldCgkcHJlZnNb
J3NwZl9leHRfZGlyJ10pKSB7CgogICAgICAgIHNhZmVfcXVlcnkoCiAgICAgICAgICAgICJD
UkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyAiLnNhZmVfcGZ4KCdzcGZfZXh0JykuIiAoCiAg
ICAgICAgICAgICAgICBmaWxlbmFtZSB2YXJjaGFyKDI1NSkgTk9UIE5VTEwgZGVmYXVsdCAn
JywKICAgICAgICAgICAgICAgIGNvbnRlbnQgbG9uZ3RleHQgTk9UIE5VTEwsCiAgICAgICAg
ICAgICAgICBQUklNQVJZIEtFWShmaWxlbmFtZSkKICAgICAgICAgICAgKSBDSEFSU0VUPXV0
ZjgiCiAgICAgICAgKTsKCiAgICAgICAgaWYoIXNhZmVfY291bnQoInNwZl9leHQiLCAiZmls
ZW5hbWU9J2R1bW15LnR4dCciKSkgewoKICAgICAgICAgICAgc2FmZV9pbnNlcnQoInNwZl9q
cyIsICJmaWxlbmFtZT0nZGVmYXVsdCcsIGNvbnRlbnQ9J0R1bW15IHRleHQgZmlsZS4uLici
KTsKCiAgICAgICAgfQoKICAgICAgICBzYWZlX2luc2VydCgKICAgICAgICAgICAgJ3R4cF9w
cmVmcycsCiAgICAgICAgICAgICJwcmVmc19pZD0xLAogICAgICAgICAgICBuYW1lPSdzcGZf
ZXh0X2RpcicsCiAgICAgICAgICAgIHZhbD0nZXh0X2ZpbGVzJywKICAgICAgICAgICAgdHlw
ZT0xLAogICAgICAgICAgICBldmVudD0nYWRtaW4nLAogICAgICAgICAgICBodG1sPSd0ZXh0
X2lucHV0JywKICAgICAgICAgICAgcG9zaXRpb249MjIiCiAgICAgICAgKTsKICAgIH0KfQoK
LyoqCiAqIExpc3QgZnVuY3Rpb24KICovCgpmdW5jdGlvbiBzcGZfZXh0X2xpc3QoJGN1cnJl
bnQpIHsKCiAgICAkb3V0W10gPSBzdGFydFRhYmxlKCdsaXN0JywgJ2xlZnQnKTsKCiAgICAk
cnMgPSBzYWZlX3Jvd3Nfc3RhcnQoJ2ZpbGVuYW1lJywgJ3NwZl9leHQnLCAiMT0xIik7Cgog
ICAgaWYgKCRycykgewoKICAgICAgICB3aGlsZSAoJGEgPSBuZXh0Um93KCRycykpIHsKICAg
ICAgICAgICAgZXh0cmFjdCgkYSk7CiAgICAgICAgICAgICRlZGl0ID0gKCRjdXJyZW50ICE9
ICRmaWxlbmFtZSkgPyBlTGluaygnc3BmX2V4dCcsICcnLCAnZmlsZW5hbWUnLCAkZmlsZW5h
bWUsICRmaWxlbmFtZSkgOiBodG1sc3BlY2lhbGNoYXJzKCRmaWxlbmFtZSk7CiAgICAgICAg
ICAgICRkZWxldGUgPSAoJGZpbGVuYW1lKSA/IGRMaW5rKCdzcGZfZXh0JywgJ3NwZl9leHRf
ZGVsZXRlJywgJ2ZpbGVuYW1lJywgJGZpbGVuYW1lKSA6ICcnOwogICAgICAgICAgICAkb3V0
W10gPSB0cih0ZCgkZWRpdCkudGQoJGRlbGV0ZSkpOwogICAgICAgIH0KCiAgICAgICAgJG91
dFtdID0gIGVuZFRhYmxlKCk7CgogICAgICAgIHJldHVybiBqb2luKCcnLCAkb3V0KTsKCiAg
ICB9Cn0KCi8qKgogKiBFZGl0IGZ1bmN0aW9uCiAqLwoKZnVuY3Rpb24gc3BmX2V4dF9lZGl0
KCRtZXNzYWdlPScnKSB7CgogICAgcGFnZXRvcChnVHh0KCdzcGZfZXh0X2ZpbGVzJyksJG1l
c3NhZ2UpOwogICAgZ2xvYmFsICRzdGVwLCAkcHJlZnM7CiAgICBzcGZfZXh0X2VkaXRfcmF3
KCk7Cgp9CgovKioKICogRWRpdCBmdW5jdGlvbiAocmF3KQogKi8KCmZ1bmN0aW9uIHNwZl9l
eHRfZWRpdF9yYXcoKSB7CgogICAgZ2xvYmFsICRldmVudCwgJHN0ZXA7CgogICAgJGZpcnN0
ID0gc2FmZV9yb3coJ2ZpbGVuYW1lJywgJ3NwZl9leHQnLCAiMT0xIik7CiAgICAkZmlyc3Rf
ZmlsZSA9ICRmaXJzdFsnZmlsZW5hbWUnXTsKCiAgICBleHRyYWN0KGdwc2EoYXJyYXkoJ2Zp
bGVuYW1lJywgJ25ld25hbWUnLCAnY29weScsICdzYXZlbmV3JykpKTsKCiAgICBpZiAoJHN0
ZXAgPT0gJ3NwZl9leHRfZGVsZXRlJyB8fCBlbXB0eSgkZmlsZW5hbWUpICYmICRzdGVwICE9
ICdwb3VyJyAmJiAhJHNhdmVuZXcpIHsKCiAgICAgICAgJGZpbGVuYW1lID0gJGZpcnN0X2Zp
bGU7CgogICAgfQoKICAgIGVsc2VpZiAoKCRjb3B5IHx8ICRzYXZlbmV3KSAmJiB0cmltKHBy
ZWdfcmVwbGFjZSgnL1s8PiYiXCddLycsICcnLCAkbmV3bmFtZSkpKSB7CgogICAgICAgICRm
aWxlbmFtZSA9ICRuZXduYW1lOwoKICAgIH0KCiAgICBpZiAoZW1wdHkoJGZpbGVuYW1lKSkg
ewoKICAgICAgICAkYnV0dG9ucyA9ICc8ZGl2IGNsYXNzPSJlZGl0LXRpdGxlIj4nLgogICAg
ICAgIGdUeHQoJ3NwZl9maWxlX25hbWUnKS4nOiAnCiAgICAgICAgLmZJbnB1dCgndGV4dCcs
J25ld25hbWUnLCcnLCdlZGl0JywnJywnJywyMCkuCiAgICAgICAgaElucHV0KCdzYXZlbmV3
Jywnc2F2ZW5ldycpLgogICAgICAgICc8L2Rpdj4nOwogICAgICAgICRmaWxlY29udGVudCA9
IGdwcygnc3BmX2V4dCcpOwoKICAgIH0gZWxzZSB7CgogICAgICAgICRidXR0b25zID0gJzxk
aXYgY2xhc3M9ImVkaXQtdGl0bGUiPicuZ1R4dCgnc3BmX2VkaXRfc2NyaXB0Jykuc3Auc3Ry
b25nKGh0bWxzcGVjaWFsY2hhcnMoJGZpbGVuYW1lKSkuJzwvZGl2Pic7CiAgICAgICAgJGZp
bGVjb250ZW50ID0gZmV0Y2goImNvbnRlbnQiLCdzcGZfZXh0JywnZmlsZW5hbWUnLCRmaWxl
bmFtZSk7CgogICAgfQoKICAgIGlmICghZW1wdHkoJGZpbGVuYW1lKSkgewoKICAgICAgICAk
Y29weSA9ICc8c3BhbiBjbGFzcz0iY29weS1hcyI+PGxhYmVsIGZvcj0iY29weS1maWxlIj4n
LmdUeHQoJ3NwZl9jb3B5X2ZpbGUnKS4nPC9sYWJlbD4nLnNwLmZJbnB1dCgndGV4dCcsICdu
ZXduYW1lJywgJycsICdlZGl0JywgJycsICcnLCAnJywgJycsICdjb3B5LWZpbGUnKS5zcC4K
ICAgICAgICAgICAgZklucHV0KCdzdWJtaXQnLCAnY29weScsIGdUeHQoJ2NvcHknKSwgJ3Nt
YWxsZXJib3gnKS4nPC9zcGFuPic7CgogICAgfSBlbHNlIHsKCiAgICAgICAgJGNvcHkgPSAn
JzsKCiAgICB9CgogICAgJHJpZ2h0ID0KICAgICc8ZGl2IGlkPSJjb250ZW50X3N3aXRjaGVy
Ij4nLgogICAgaGVkKGdUeHQoJ3NwZl9hbGxfZmlsZXMnKSwyKS4KICAgIGdyYWYoc0xpbmso
J3NwZl9leHQnLCAncG91cicsIGdUeHQoJ3NwZl9jcmVhdGVfbmV3X2ZpbGUnKSksICcgY2xh
c3M9ImFjdGlvbi1jcmVhdGUgc21hbGxlcmJveCInKS4KICAgIHNwZl9leHRfbGlzdCgkZmls
ZW5hbWUpLgogICAgJzwvZGl2Pic7CgogICAgZWNobwogICAgJzxkaXYgaWQ9IicuJGV2ZW50
LidfY29udGFpbmVyIiBjbGFzcz0idHhwLWNvbnRhaW5lciB0eHAtZWRpdCI+Jy4KICAgIHN0
YXJ0VGFibGUoJ2VkaXQnKS4KICAgIHRyKAogICAgICAgIHRkKAogICAgICAgICAgICBmb3Jt
KAogICAgICAgICAgICAgICAgJzxkaXYgaWQ9Im1haW5fY29udGVudCI+Jy4KICAgICAgICAg
ICAgICAgICRidXR0b25zLgogICAgICAgICAgICAgICAgJzx0ZXh0YXJlYSBpZD0ic3BmX2V4
dCIgY2xhc3M9ImNvZGUiIG5hbWU9InNwZl9leHQiIGNvbHM9Ijc4IiByb3dzPSIzMiIgc3R5
bGU9Im1hcmdpbi10b3A6IDZweDsgd2lkdGg6IDcwMHB4OyBoZWlnaHQ6IDUxNXB4OyI+Jy5o
dG1sc3BlY2lhbGNoYXJzKCRmaWxlY29udGVudCkuJzwvdGV4dGFyZWE+Jy5ici4KICAgICAg
ICAgICAgICAgIGZJbnB1dCgnc3VibWl0JywnJyxnVHh0KCdzYXZlJyksJ3B1Ymxpc2gnKS4K
ICAgICAgICAgICAgICAgIGVJbnB1dCgnc3BmX2V4dCcpLnNJbnB1dCgnc3BmX2V4dF9zYXZl
JykuCiAgICAgICAgICAgICAgICBoSW5wdXQoJ2ZpbGVuYW1lJywkZmlsZW5hbWUpCiAgICAg
ICAgICAgICAgICAuJGNvcHkuCiAgICAgICAgICAgICAgICAnPC9kaXY+JwogICAgICAgICAg
ICAsICcnLCAnJywgJ3Bvc3QnLCAnZWRpdC1mb3JtJywgJycsICdzdHlsZV9mb3JtJykKICAg
ICAgICAsICcnLCAnY29sdW1uJykuCiAgICAgICAgdGR0bCgKICAgICAgICAgICAgJHJpZ2h0
CiAgICAgICAgLCAnIGNsYXNzPSJjb2x1bW4iJykKICAgICkuCiAgICBlbmRUYWJsZSgpLgog
ICAgJzwvZGl2Pic7Cn0KCi8qKgogKiBDb3B5IGZ1bmN0aW9uCiAqCiAqLwoKZnVuY3Rpb24g
c3BmX2V4dF9jb3B5KCkgewoKICAgIGV4dHJhY3QoZ3BzYShhcnJheSgnb2xkbmFtZScsICdu
ZXduYW1lJykpKTsKCiAgICAkY29udGVudCA9IGRvU2xhc2goZmV0Y2goJ2NvbnRlbnQnLCAn
c3BmX2V4dCcsICdmaWxlbmFtZScsICRvbGRuYW1lKSk7CgogICAgJHJzID0gc2FmZV9pbnNl
cnQoJ3NwZl9leHQnLCAiY29udGVudCA9ICckY29udGVudCcsIGZpbGVuYW1lID0gJyIuZG9T
bGFzaCgkbmV3bmFtZSkuIiciKTsKCiAgICBzcGZfZXh0X2VkaXQoCiAgICAgICAgZ1R4dCgn
c3BmX2ZpbGVfY3JlYXRlZCcsIGFycmF5KCd7bmFtZX0nID0+ICRuZXduYW1lKSkKICAgICk7
Cn0KCi8qKgogKiBTYXZlIGZ1bmN0aW9uCiAqLwoKZnVuY3Rpb24gc3BmX2V4dF9zYXZlKCkg
ewoKICAgIGV4dHJhY3QoZ3BzYShhcnJheSgnZmlsZW5hbWUnLCdzcGZfZXh0Jywnc2F2ZW5l
dycsJ25ld25hbWUnLCdjb3B5JykpKTsKICAgICRjb250ZW50ID0gZG9TbGFzaCgkc3BmX2V4
dCk7CgogICAgaWYgKCRzYXZlbmV3IG9yICRjb3B5KSB7CgogICAgICAgICRuZXduYW1lID0g
ZG9TbGFzaCh0cmltKHByZWdfcmVwbGFjZSgnL1s8PiYiXCddLycsICcnLCBncHMoJ25ld25h
bWUnKSkpKTsKCiAgICAgICAgaWYgKCRuZXduYW1lIGFuZCBzYWZlX2ZpZWxkKCdmaWxlbmFt
ZScsICdzcGZfZXh0JywgImZpbGVuYW1lID0gJyRuZXduYW1lJyIpKSB7CgogICAgICAgICAg
ICAkbWVzc2FnZSA9IGdUeHQoJ3NwZl9maWxlX2V4aXN0cycsIGFycmF5KCd7bmFtZX0nID0+
ICRuZXduYW1lKSk7CgogICAgICAgICAgICBpZiAoJHNhdmVuZXcpIHsKCiAgICAgICAgICAg
ICAgICAkX1BPU1RbJ25ld25hbWUnXSA9ICcnOwoKICAgICAgICAgICAgfQoKICAgICAgICB9
IGVsc2VpZiAoJG5ld25hbWUpIHsKCiAgICAgICAgICAgIHNhZmVfaW5zZXJ0KCdzcGZfZXh0
JywgImZpbGVuYW1lID0gJyIuJG5ld25hbWUuIicsIGNvbnRlbnQgPSAnJGNvbnRlbnQnIik7
CgogICAgICAgICAgICAkbWVzc2FnZSA9IGdUeHQoJ3NwZl9maWxlX2NyZWF0ZWQnLCBhcnJh
eSgne25hbWV9JyA9PiAkbmV3bmFtZSkpOwoKICAgICAgICAgICAgc3BmX2V4dF93cml0ZSgp
OwoKICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgJG1lc3NhZ2UgPSBhcnJheShnVHh0
KCdzcGZfZmlsZV9uYW1lX3JlcXVpcmVkJyksIEVfRVJST1IpOwoKICAgICAgICB9CgogICAg
ICAgIHNwZl9leHRfZWRpdCgkbWVzc2FnZSk7CgogICAgfSBlbHNlIHsKCiAgICAgICAgc2Fm
ZV91cGRhdGUoJ3NwZl9leHQnLCAiY29udGVudCA9ICckY29udGVudCciLCAiZmlsZW5hbWUg
PSAnIi5kb1NsYXNoKCRmaWxlbmFtZSkuIiciKTsKCiAgICAgICAgJG1lc3NhZ2UgPSBnVHh0
KCdzcGZfZmlsZV91cGRhdGVkJywgYXJyYXkoJ3tuYW1lfScgPT4gJGZpbGVuYW1lKSk7Cgog
ICAgICAgIHNwZl9leHRfd3JpdGUoKTsKCiAgICAgICAgc3BmX2V4dF9lZGl0KCRtZXNzYWdl
KTsKCiAgICB9Cgp9CgovKioKICogV3JpdGUgZnVuY3Rpb24KICovCgpmdW5jdGlvbiBzcGZf
ZXh0X3dyaXRlKCkgewoKICAgIGdsb2JhbCAkcHJlZnM7CiAgICBleHRyYWN0KGdwc2EoYXJy
YXkoJ2ZpbGVuYW1lJywnc3BmX2V4dCcsJ3NhdmVuZXcnLCduZXduYW1lJywnY29weScpKSk7
CgogICAgJGZpbGVuYW1lID0gKHBzKCdjb3B5Jykgb3IgcHMoJ3NhdmVuZXcnKSkgPyBwcygn
bmV3bmFtZScpIDogcHMoJ2ZpbGVuYW1lJyk7CiAgICAkZmlsZSA9ICRwcmVmc1sncGF0aF90
b19zaXRlJ10uJy8nLiRwcmVmc1snc3BmX2V4dF9kaXInXS4nLycuJGZpbGVuYW1lOwoKICAg
IGlmIChlbXB0eSgkcHJlZnNbJ3NwZl9leHRfZGlyJ10pIG9yICEkZmlsZW5hbWUpIHsKCiAg
ICAgICAgcmV0dXJuOwoKICAgIH0gZWxzZSB7CgogICAgJGNvbnRlbnRfcmF3ID0gZmV0Y2go
ImNvbnRlbnQiLCAic3BmX2V4dCIsICdmaWxlbmFtZScsICRmaWxlbmFtZSk7IC8vIE1vdmVk
IGhlcmUgdG8gc2F2ZSBuZXdseS1jcmVhdGVkIGZpbGVzCgogICAgICAgICRoYW5kbGUgPSBm
b3BlbigkZmlsZSwgJ3diJyk7CiAgICAgICAgZndyaXRlKCRoYW5kbGUsICRjb250ZW50X3Jh
dyk7CiAgICAgICAgZmNsb3NlKCRoYW5kbGUpOwogICAgICAgIGNobW9kKCRmaWxlLCAwNjQ0
KTsKICAgIH0KCn0KCi8qKgogKiBEZWxldGUgZnVuY3Rpb24KICovCgpmdW5jdGlvbiBzcGZf
ZXh0X2RlbGV0ZSgpIHsKCiAgICBnbG9iYWwgJHByZWZzOwoKICAgICRmaWxlbmFtZSA9IHBz
KCdmaWxlbmFtZScpOwogICAgJGZpbGUgPSAkcHJlZnNbJ3BhdGhfdG9fc2l0ZSddLicvJy4k
cHJlZnNbJ3NwZl9leHRfZGlyJ10uJy8nLiRmaWxlbmFtZTsKCiAgICAgICAgaWYgKCFlbXB0
eSgkcHJlZnNbJ3NwZl9leHRfZGlyJ10pIGFuZCAkZmlsZW5hbWUpIHsKCiAgICAgICAgICAg
IHNhZmVfZGVsZXRlKCdzcGZfZXh0JywgImZpbGVuYW1lID0gJyIuZG9TbGFzaCgkZmlsZW5h
bWUpLiInIik7CgogICAgICAgICAgICBAdW5saW5rKCRmaWxlKTsKCiAgICAgICAgc3BmX2V4
dF9lZGl0KAoKICAgICAgICAgICAgZ1R4dCgnc3BmX2ZpbGVfZGVsZXRlZCcsIGFycmF5KCd7
bmFtZX0nID0+ICRmaWxlbmFtZSkpCiAgICAgICAgKTsKCiAgICB9IGVsc2UgewogICAgICAg
IHJldHVybjsKICAgIH0KCn0iO3M6MzoibWQ1IjtzOjMyOiJmMDc4MzMzM2Y2NDdiY2Q4YmQ2
NDQ5NmNjNDRhZjdjYyI7fQ==
