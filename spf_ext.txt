# spf_ext v0.31
# External file editor
# Simon Finch
# https://github.com/spiffin/spf_ext

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMjp7czo0OiJuYW1lIjtzOjc6InNwZl9leHQiO3M6NzoidmVyc2lvbiI7czo0OiIwLjMx
IjtzOjY6ImF1dGhvciI7czoxMToiU2ltb24gRmluY2giO3M6MTA6ImF1dGhvcl91cmkiO3M6
MzQ6Imh0dHBzOi8vZ2l0aHViLmNvbS9zcGlmZmluL3NwZl9leHQiO3M6MTE6ImRlc2NyaXB0
aW9uIjtzOjIwOiJFeHRlcm5hbCBmaWxlIGVkaXRvciI7czo1OiJvcmRlciI7czoxOiI1Ijtz
OjQ6InR5cGUiO3M6MToiMyI7czo1OiJmbGFncyI7czoxOiIyIjtzOjg6InRleHRwYWNrIjtz
OjU4NzoiI0BzcGZfZXh0CnNwZl9leHRfZmlsZXMgPT4gRXh0ZXJuYWwgRmlsZXMKc3BmX2V4
dF9kaXIgPT4gRXh0ZXJuYWwgZmlsZXMgZGlyZWN0b3J5CnNwZl9maWxlbmFtZSA9PiBGaWxl
bmFtZQpzcGZfZWRpdF9maWxlID0+IFlvdSBhcmUgZWRpdGluZyBmaWxlCnNwZl9hbGxfZmls
ZXMgPT4gQWxsIEZpbGVzCnNwZl9maWxlX3VwZGF0ZWQgPT4gRmlsZSA8c3Ryb25nPntuYW1l
fTwvc3Ryb25nPiB1cGRhdGVkLgpzcGZfZmlsZV9uYW1lID0+IEV4dGVybmFsIGZpbGUgbmFt
ZQpzcGZfY29weV9maWxlID0+ICYjODIzMDtvciBjb3B5IGZpbGUgYXMKc3BmX2NyZWF0ZV9u
ZXdfZmlsZSA9PiBDcmVhdGUgbmV3IGZpbGUKc3BmX2ZpbGVfY3JlYXRlZCA9PiBGaWxlIDxz
dHJvbmc+e25hbWV9PC9zdHJvbmc+IGNyZWF0ZWQuCnNwZl9maWxlX25hbWVfcmVxdWlyZWQg
PT4gUGxlYXNlIHByb3ZpZGUgYSBuYW1lIGZvciB5b3VyIGZpbGUuCnNwZl9maWxlX2V4aXN0
cyA9PiBGaWxlIDxzdHJvbmc+e25hbWV9PC9zdHJvbmc+IGFscmVhZHkgZXhpc3RzLgpzcGZf
ZmlsZV9kZWxldGVkID0+IEZpbGUgPHN0cm9uZz57bmFtZX08L3N0cm9uZz4gZGVsZXRlZC4i
O3M6NDoiaGVscCI7czozMjYxOiI8aDE+c3BmX2V4dDwvaDE+Cgo8cD5FeHRlcm5hbCBmaWxl
IGVkaXRvciBwbHVnaW4uIENyZWF0ZSwgZWRpdCBhbmQgZGVsZXRlIGV4dGVybmFsICh0byBU
ZXh0cGF0dGVybikgZmlsZXMgaW4gVGV4dHBhdHRlcm4gYWRtaW4uPC9wPgo8cD48c3Ryb25n
PlJFUVVJUkVTOiBUZXhwYXR0ZXJuIDQuNS4xIGFuZCBQSFAgNSBhbmQgc2hlbGwgYWNjZXNz
IChmb3Igc3ltLWxpbmtpbmcgZXhpc3RpbmcgZmlsZXMpLjwvc3Ryb25nPjwvcD4KPHA+PGEg
aHJlZj0iaHR0cHM6Ly9naXRodWIuY29tL3NwaWZmaW4vc3BmX2V4dC9ibG9iL21hc3Rlci9z
cGZfZXh0X3YwLjIudHh0Ij5Vc2UgdGhpcyB2ZXJzaW9uIGZvciBUZXh0cGF0dGVybiA0LjQu
MSBhbmQgYmVsb3c8L2E+LjwvcD4KPHA+PHN0cm9uZz5QbGVhc2UgcmVhZCB0aGUgaW5zdHJ1
Y3Rpb25zIGFuZCBub3RlcyBiZWxvdyBiZWZvcmUgdXNlLjwvc3Ryb25nPjwvcD4KPHA+VGhp
cyBwbHVnaW4gY3JlYXRlcyBleHRlcm5hbCBmaWxlcyB5b3UgY2FuIG1hbmFnZSBhbmQgZWRp
dCB2aWEgdGhlIGFkbWluIGludGVyZmFjZS4gQWxsIGZpbGVzIGFyZSBzYXZlZCB0byB0aGUg
ZGlyZWN0b3J5IHlvdSBjcmVhdGUgaW4gc3RlcCAxIG9mIHRoZSBpbnN0cnVjdGlvbnMgYmVs
b3cuIFN5bnRheCBoaWdobGlnaHRpbmcgaXMgYXZhaWxhYmxlIHZpYSA8YSBocmVmPSJodHRw
czovL2dpdGh1Yi5jb20vc3BpZmZpbi9zcGZfY29kZW1pcnJvciI+c3BmX2NvZGVtaXJyb3I8
L2E+IChjdXJyZW50bHkgSFRNTCwgUEhQIGFuZCBKYXZhU2NyaXB0IC0gbW9yZSB0byBjb21l
KS48L3A+Cgo8aDI+V2h5PzwvaDI+Cjx1bD4KPGxpPlRoaXMgcGx1Z2luIGFsbG93cyB5b3Ug
dG8gZWRpdCBhbmQgbWFuYWdlIHNpdGUgZmlsZXMgcmVzaWRpbmcgb3V0c2lkZSBUZXh0cGF0
dGVybiB3aXRoaW4gdGhlIFRleHRwYXR0ZXJuIGFkbWluIGFyZWEgKHNlZSDigJhQcm9jZWR1
cmUgZm9yIG1hbmFnaW5nIGV4aXN0aW5nIGZpbGVz4oCZIGJlbG93KS48L2xpPgo8bGk+SXQg
b2ZmZXJzIGFuIGVhc3kgd2F5IHRvIGNyZWF0ZSBzdGF0aWMgZmlsZXMgeW91IGNhbiBlZGl0
IGFuZCBhY2Nlc3MgdmlhIHlvdXIgcGFnZSB0ZW1wbGF0ZXM6IDxjb2RlPiZsdDt0eHA6c2l0
ZV91cmwgLyZndDtleHRfZmlsZXMveW91cmZpbGUuaHRtbDwvY29kZT48L2xpPgo8L3VsPgoK
PGhyIC8+Cgo8aDI+SW5zdHJ1Y3Rpb25zOjwvaDI+Cgo8b2w+CjxsaT5DcmVhdGUgYSBkaXJl
Y3RvcnkgZm9yIHRoZSBzdGF0aWMgZXh0ZXJuYWwgZmlsZXMgaW4gdGhlIHJvb3Qgb2YgeW91
ciB0ZXh0cGF0dGVybiBpbnN0YWxsYXRpb24gY2FsbGVkIOKAmGV4dF9maWxlc+KAmSAob3Ig
d2hhdGV2ZXIgeW91IGxpa2UpLiBZb3Ugc2hvdWxkIG1ha2Ugc3VyZSB0aGF0IFBIUCBpcyBh
YmxlIHRvIHdyaXRlIHRvIHRoYXQgZGlyZWN0b3J5LjwvbGk+CjxsaT5WaXNpdCB0aGUgYWR2
YW5jZWQgcHJlZmVyZW5jZXMgYW5kIG1ha2Ugc3VyZSB0aGUg4oCcRXh0ZXJuYWwgZmlsZXMg
ZGlyZWN0b3J54oCdIHByZWZlcmVuY2UgY29udGFpbnMgdGhlIGRpcmVjdG9yeSB5b3UgY3Jl
YXRlZCBpbiBzdGVwIDEgKGJ5IGRlZmF1bHQg4oCYZXh0X2ZpbGVz4oCZKS4gVGhpcyBwYXRo
IGlzIHJlbGF0aXZlIHBhdGggdG8gdGhlIGRpcmVjdG9yeSBvZiB5b3VyIHJvb3QgVGV4dHBh
dHRlcm4gaW5zdGFsbGF0aW9uLjwvbGk+CjxsaT5BY3RpdmF0ZSB0aGlzIHBsdWdpbi48L2xp
Pgo8bGk+R28gdG8gRXh0ZW5zaW9ucyAmZ3Q7IEV4dGVybmFsIEZpbGVzIGFuZCBjcmVhdGUg
ZmlsZXMgeW914oCZZCBsaWtlIHRvIG1hbmFnZS48L2xpPgo8bGk+QWx3YXlzIGluY2x1ZGUg
YSBmaWxlIGV4dGVuc2lvbiBpbiB0aGUgZmlsZSBuYW1lICguaHRtbCwgLnBocCwgZXRjLiku
PC9saT4KPC9vbD4KCjxoMj5Qcm9jZWR1cmUgZm9yIG1hbmFnaW5nIGV4aXN0aW5nIGZpbGVz
OjwvaDI+CjxvbD4KPGxpPkNvcHkgdGhlIGNvbnRlbnRzIG9mIHRoZSBmaWxlIChjYWxsZWQg
Zm9yIGV4YW1wbGUgbXlmaWxlLnBocCkgaW50byBhIG5ldyBmaWxlIGluIEV4dGVuc2lvbnMg
Jmd0OyBFeHRlcm5hbCBGaWxlcyAmZ3Q7IENyZWF0ZSBuZXcgZmlsZS48L2xpPgo8bGk+TmFt
ZSB0aGUgbmV3IGZpbGUgKEV4dGVybmFsIGZpbGUgbmFtZTopIOKAmG15ZmlsZS5waHDigJku
PC9saT4KPGxpPlJlbmFtZSB0aGUgb3JpZ2luYWwgZmlsZSAodG8sIGZvciBleGFtcGxlLCDi
gJhteWZpbGVfb3JpZ2luYWwucGhw4oCZKSAtIHRoZW4geW914oCZbGwgaGF2ZSBhIGJhY2t1
cC48L2xpPgo8bGk+TWFrZSBhIHN5bWJvbGljIGxpbmssIGluIHRoZSBvcmlnaW5hbCBmaWxl
IGxvY2F0aW9uLCB0byB0aGUgbmV3IGZpbGUgKGUuZy4gY2QgdG8gdGhlIOKAmGV4dF9maWxl
c+KAmSBkaXJlY3RvcnkgYW5kIHRoZW4g4oCYbG4gLXMgL29yaWdpbmFsX2RpcmVjdG9yeV9w
YXRoL215ZmlsZS5waHAgLi9teWZpbGUucGhw4oCZKS48L2xpPgo8L29sPgoKPGhyIC8+Cgo8
aDI+Tm90ZXM6PC9oMj4KPG9sPgo8bGk+WW91IGNhbiBvbmx5IG1hbmFnZSBmaWxlcyB3aGlj
aCBhcmUgcmVhZC93cml0ZSB0byB5b3VyIHdlYiBzZXJ2ZXIgZS5nLiBNaW5pZnkgY29uZmln
IGZpbGVzLCBleHRlcm5hbCBzY3JpcHRzLCBldGMuPC9saT4KPGxpPkRlbGV0aW5nIGEgZmls
ZSB2aWEgdGhlIEV4dGVybmFsIEZpbGVzIHRhYiBkZWxldGVzIHRoZSBhY3R1YWwgZmlsZSBp
biB0aGUg4oCZZXh0X2ZpbGVz4oCZIGRpcmVjdG9yeSAoYXMgd2VsbCBhcyB0aGUgZGF0YWJh
c2UgZW50cnkpIC0gdXNlIHdpdGggY2FyZSEuPC9saT4KPC9vbD4KCgo8aDI+TGFuZ3VhZ2Vz
IChUZXh0cGFjayk8L2gyPgo8dWw+CjxsaT5UaGlzIHBsdWdpbiBpbnN0YWxscyBhbiBFbmds
aXNoIFRleHRwYWNrIGJ5IGRlZmF1bHQuPC9saT4KPGxpPlRvIGluc3RhbGwgYSBUZXh0cGFj
ayBmb3IgeW91ciBvd24gbGFuZ3VhZ2Ugc2VlIHRoZSA8YSBocmVmPSJodHRwczovL2dpdGh1
Yi5jb20vc3BpZmZpbi9zcGZfZXh0L2Jsb2IvbWFzdGVyL3NwZl9leHRfdGV4dHBhY2sudHh0
Ij5pbnN0cnVjdGlvbnMgb24gR2l0SHViPC9hPi48L2xpPgo8L3VsPgoKPGgyPlZlcnNpb24g
aGlzdG9yeTwvaDI+Cjx1bD4KPGxpPjAuMzEgLSA3IE5vdmVtYmVyIDIwMTIgLSByZXdyaXR0
ZW4gZm9yIFRleHRwYXR0ZXJuIDQuNS54LjwvbGk+CjxsaT4wLjIgLSAyNiBBdWd1c3QgMjAx
MiAtIHNlY3VyaXR5IGVuaGFuY2VtZW50cyAodGhhbmtzIEp1a2thKS48L2xpPgo8bGk+MC4x
IC0gQXByaWwgMjAxMiAtIGZpcnN0IHJlbGVhc2UuPC9saT4KPC91bD4iO3M6NDoiY29kZSI7
czo4ODgxOiIvKioKICogc3BmX2V4dCAtIEV4dGVybmFsIGZpbGUgZWRpdG9yIGZvciBUZXh0
cGF0dGVybgogKgogKiDCqSAyMDEyIFNpbW9uIEZpbmNoIC0gaHR0cHM6Ly9naXRodWIuY29t
L3NwaWZmaW4vc3BmX2V4dAogKgogKiBMaWNlbnNlZCB1bmRlciBHTlUgR2VuZXJhbCBQdWJs
aWMgTGljZW5zZSB2ZXJzaW9uIDIKICogaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL2dw
bC0yLjAuaHRtbAogKgogKiBWZXJzaW9uIDAuMzEgLS0gNyBOb3ZlbWJlciAyMDEyCiAqLwoK
LyoqCiAqIFNldHVwIHRhYnMgYW5kIGNhbGxiYWNrCiAqLwoKaWYgKEB0eHBpbnRlcmZhY2Ug
PT0gJ2FkbWluJykgewoKICAgIGFkZF9wcml2cygnc3BmX2V4dCcsICcxJyk7CiAgICByZWdp
c3Rlcl90YWIoJ2V4dGVuc2lvbnMnLCAnc3BmX2V4dCcsIGdUeHQoJ3NwZl9leHRfZmlsZXMn
KSk7CiAgICByZWdpc3Rlcl9jYWxsYmFjaygnc3BmX2V4dF9ndWknLCAnc3BmX2V4dCcpOwog
ICAgcmVnaXN0ZXJfY2FsbGJhY2soJ3NwZl9leHRfaW5zdGFsbCcsICdwbHVnaW5fbGlmZWN5
Y2xlLnNwZl9leHQnLCAnaW5zdGFsbGVkJyk7CiAgICByZWdpc3Rlcl9jYWxsYmFjaygnc3Bm
X2V4dF9yZW1vdmUnLCAncGx1Z2luX2xpZmVjeWNsZS5zcGZfZXh0JywgJ2RlbGV0ZWQnKTsK
Cn0KCi8qKgogKiBHVUkgZnVuY3Rpb25zIC8gc3RlcCBkaXNwYXRjaGVyCiAqLwoKZnVuY3Rp
b24gc3BmX2V4dF9ndWkoKSB7CgogICAgZ2xvYmFsICRldmVudCwgJHN0ZXA7CgogICAgaWYg
KCRldmVudCA9PSAnc3BmX2V4dCcpIHsKICAgICAgICByZXF1aXJlX3ByaXZzKCdzcGZfZXh0
Jyk7CgogICAgICAgIGJvdW5jZXIoJHN0ZXAsCiAgICAgICAgICAgIGFycmF5KAogICAgICAg
ICAgICAgICAgJ3NwZl9leHRfZWRpdF9yYXcnICAgPT4gZmFsc2UsCiAgICAgICAgICAgICAg
ICAncG91cicgICAgICAgICAgICAgID0+IGZhbHNlLAogICAgICAgICAgICAgICAgJ3NwZl9l
eHRfc2F2ZScgICAgICAgPT4gdHJ1ZSwKICAgICAgICAgICAgICAgICdzcGZfZXh0X2NvcHkn
ICAgICAgID0+IHRydWUsCiAgICAgICAgICAgICAgICAnc3BmX2V4dF9kZWxldGUnICAgICA9
PiB0cnVlLAogICAgICAgICAgICAgICAgJ3NwZl9leHRfZWRpdCcgICAgICAgPT4gZmFsc2Us
CiAgICAgICAgICAgICkKICAgICAgICApOwoKICAgICAgICBzd2l0Y2ggKCRzdGVwKSB7CiAg
ICAgICAgICAgIGNhc2UgJyc6IHNwZl9leHRfZWRpdCgpOyAgICAgICAgICAgICAgICAgICAg
ICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnc3BmX2V4dF9lZGl0X3Jhdyc6IHNwZl9l
eHRfZWRpdCgpOyAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAncG91cic6IHNw
Zl9leHRfZWRpdCgpOyAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj
YXNlICdzcGZfZXh0X3NhdmUnOiBzcGZfZXh0X3NhdmUoKTsgICAgICAgICAgICAgIGJyZWFr
OwogICAgICAgICAgICBjYXNlICdzcGZfZXh0X2NvcHknOiBzcGZfZXh0X2NvcHkoKTsgICAg
ICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICdzcGZfZXh0X2RlbGV0ZSc6IHNw
Zl9leHRfZGVsZXRlKCk7ICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICdzcGZf
ZXh0X2VkaXQnOiBzcGZfZXh0X2VkaXQoKTsKICAgICAgICB9CiAgICB9Cn0KCi8qKgogKiBS
ZW1vdmFsIGZ1bmN0aW9uCiAqLwoKZnVuY3Rpb24gc3BmX2V4dF9yZW1vdmUoJGV2ZW50LCAk
c3RlcCkgewpnbG9iYWwgJHByZWZzLCAkc3RlcDsKCiAgICBpZihpc3NldCgkcHJlZnNbJ3Nw
Zl9leHRfZGlyJ10pKSB7CgogICAgICAgIHNhZmVfZGVsZXRlKAogICAgICAgICAgICAndHhw
X3ByZWZzJywKICAgICAgICAgICAgIm5hbWU9J3NwZl9leHRfZGlyJyIKICAgICAgICApOwoK
ICAgICAgICAvLyBEb24ndCBkcm9wIHRoZSB0YWJsZSAtIGp1c3QgaW4gY2FzZS4uCiAgICAg
ICAgLy9Ac2FmZV9xdWVyeSgKICAgICAgICAvLyAgICAnRFJPUCBUQUJMRSBJRiBFWElTVFMg
Jy5zYWZlX3BmeCgnc3BmX2V4dCcpCiAgICAgICAgLy8pOwoKICAgICAgICAvLyBkZWxldGUg
dGhlIFRleHRwYWNrCgogICAgICAgIHNhZmVfZGVsZXRlKAogICAgICAgICAgICAndHhwX2xh
bmcnLAogICAgICAgICAgICAiZXZlbnQgPSAnc3BmX2V4dCciCiAgICAgICAgKTsKCiAgICB9
Cgp9CgovKioKICogSW5zdGFsbGVyIGZ1bmN0aW9uCiAqLwoKZnVuY3Rpb24gc3BmX2V4dF9p
bnN0YWxsKCRldmVudCwgJHN0ZXApIHsKZ2xvYmFsICRwcmVmcywgJHN0ZXA7CgogICAgaWYo
IWlzc2V0KCRwcmVmc1snc3BmX2V4dF9kaXInXSkpIHsKCiAgICAgICAgc2FmZV9xdWVyeSgK
ICAgICAgICAgICAgIkNSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTICIuc2FmZV9wZngoJ3Nw
Zl9leHQnKS4iICgKICAgICAgICAgICAgICAgIGZpbGVuYW1lIHZhcmNoYXIoMjU1KSBOT1Qg
TlVMTCBkZWZhdWx0ICcnLAogICAgICAgICAgICAgICAgY29udGVudCBsb25ndGV4dCBOT1Qg
TlVMTCwKICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZKGZpbGVuYW1lKQogICAgICAgICAg
ICApIENIQVJTRVQ9dXRmOCIKICAgICAgICApOwoKICAgICAgICBpZighc2FmZV9jb3VudCgi
c3BmX2V4dCIsICJmaWxlbmFtZT0naG9sZGVyLnR4dCciKSkgewoKICAgICAgICAgICAgc2Fm
ZV9pbnNlcnQoInNwZl9leHQiLCAiZmlsZW5hbWU9J2hvbGRlci50eHQnLCBjb250ZW50PSdI
b2xkZXIgdGV4dCBmaWxlLi4ueW91IG5lZWQgYXQgbGVhc3Qgb25lIGZpbGUgaGVyZS4nIik7
CgogICAgICAgIH0KCiAgICAgICAgc2FmZV9pbnNlcnQoCiAgICAgICAgICAgICd0eHBfcHJl
ZnMnLAogICAgICAgICAgICAicHJlZnNfaWQ9MSwKICAgICAgICAgICAgbmFtZT0nc3BmX2V4
dF9kaXInLAogICAgICAgICAgICB2YWw9J2V4dF9maWxlcycsCiAgICAgICAgICAgIHR5cGU9
MSwKICAgICAgICAgICAgZXZlbnQ9J2FkbWluJywKICAgICAgICAgICAgaHRtbD0ndGV4dF9p
bnB1dCcsCiAgICAgICAgICAgIHBvc2l0aW9uPTIyIgogICAgICAgICk7CiAgICB9Cn0KCi8q
KgogKiBMaXN0IGZ1bmN0aW9uCiAqLwoKZnVuY3Rpb24gc3BmX2V4dF9saXN0KCRjdXJyZW50
KSB7CgogICAgLy8kb3V0W10gPSBzdGFydFRhYmxlKCdsaXN0JywgJ2xlZnQnKTsKCiRvdXRb
XSA9IHN0YXJ0VGFibGUoJycsICcnLCAndHhwLWxpc3QnKTsKCiAgICAkcnMgPSBzYWZlX3Jv
d3Nfc3RhcnQoJ2ZpbGVuYW1lJywgJ3NwZl9leHQnLCAiMT0xIik7CgogICAgaWYgKCRycykg
ewoKICAgICAgICB3aGlsZSAoJGEgPSBuZXh0Um93KCRycykpIHsKICAgICAgICAgICAgZXh0
cmFjdCgkYSk7CiAgICAgICAgICAgICRlZGl0ID0gKCRjdXJyZW50ICE9ICRmaWxlbmFtZSkg
PyBlTGluaygnc3BmX2V4dCcsICcnLCAnZmlsZW5hbWUnLCAkZmlsZW5hbWUsICRmaWxlbmFt
ZSkgOiB0eHBzcGVjaWFsY2hhcnMoJGZpbGVuYW1lKTsKICAgICAgICAgICAgJGRlbGV0ZSA9
ICgkZmlsZW5hbWUpID8gZExpbmsoJ3NwZl9leHQnLCAnc3BmX2V4dF9kZWxldGUnLCAnZmls
ZW5hbWUnLCAkZmlsZW5hbWUpIDogJyc7CiAgICAgICAgICAgICRvdXRbXSA9IHRyKHRkKCRl
ZGl0KS50ZCgkZGVsZXRlKSk7CiAgICAgICAgfQoKICAgICAgICAkb3V0W10gPSAgZW5kVGFi
bGUoKTsKCiAgICAgICAgcmV0dXJuIGpvaW4oJycsICRvdXQpOwoKICAgIH0KfQoKLyoqCiAq
IEVkaXQgZnVuY3Rpb24KICovCgpmdW5jdGlvbiBzcGZfZXh0X2VkaXQoJG1lc3NhZ2U9Jycp
IHsKCiAgICBwYWdldG9wKGdUeHQoJ3NwZl9leHRfZmlsZXMnKSwkbWVzc2FnZSk7CiAgICBn
bG9iYWwgJHN0ZXAsICRwcmVmczsKICAgIHNwZl9leHRfZWRpdF9yYXcoKTsKCn0KCi8qKgog
KiBFZGl0IGZ1bmN0aW9uIChyYXcpCiAqLwoKZnVuY3Rpb24gc3BmX2V4dF9lZGl0X3Jhdygp
IHsKCiAgICBnbG9iYWwgJGV2ZW50LCAkc3RlcDsKCiAgICAkZmlyc3QgPSBzYWZlX3Jvdygn
ZmlsZW5hbWUnLCAnc3BmX2V4dCcsICIxPTEiKTsKICAgICRmaXJzdF9maWxlID0gJGZpcnN0
WydmaWxlbmFtZSddOwoKICAgIGV4dHJhY3QoZ3BzYShhcnJheSgnZmlsZW5hbWUnLCAnbmV3
bmFtZScsICdjb3B5JywgJ3NhdmVuZXcnKSkpOwoKICAgIGlmICgkc3RlcCA9PSAnc3BmX2V4
dF9kZWxldGUnIHx8IGVtcHR5KCRmaWxlbmFtZSkgJiYgJHN0ZXAgIT0gJ3BvdXInICYmICEk
c2F2ZW5ldykgewoKICAgICAgICAkZmlsZW5hbWUgPSAkZmlyc3RfZmlsZTsKCiAgICB9Cgog
ICAgZWxzZWlmICgoJGNvcHkgfHwgJHNhdmVuZXcpICYmIHRyaW0ocHJlZ19yZXBsYWNlKCcv
Wzw+JiJcJ10vJywgJycsICRuZXduYW1lKSkpIHsKCiAgICAgICAgJGZpbGVuYW1lID0gJG5l
d25hbWU7CgogICAgfQoKICAgIGlmIChlbXB0eSgkZmlsZW5hbWUpKSB7CgogICAgICAgICRi
dXR0b25zID0gJzxkaXYgY2xhc3M9ImVkaXQtdGl0bGUiPicuCiAgICAgICAgZ1R4dCgnc3Bm
X2ZpbGVfbmFtZScpLic6ICcKICAgICAgICAuZklucHV0KCd0ZXh0JywnbmV3bmFtZScsJycs
J2VkaXQnLCcnLCcnLDIwKS4KICAgICAgICBoSW5wdXQoJ3NhdmVuZXcnLCdzYXZlbmV3Jyku
CiAgICAgICAgJzwvZGl2Pic7CiAgICAgICAgJGZpbGVjb250ZW50ID0gZ3BzKCdzcGZfZXh0
Jyk7CgogICAgfSBlbHNlIHsKCiAgICAgICAgJGJ1dHRvbnMgPSAnPGRpdiBjbGFzcz0iZWRp
dC10aXRsZSI+Jy5nVHh0KCdzcGZfZWRpdF9zY3JpcHQnKS5zcC5zdHJvbmcodHhwc3BlY2lh
bGNoYXJzKCRmaWxlbmFtZSkpLic8L2Rpdj4nOwogICAgICAgICRmaWxlY29udGVudCA9IGZl
dGNoKCJjb250ZW50Iiwnc3BmX2V4dCcsJ2ZpbGVuYW1lJywkZmlsZW5hbWUpOwoKICAgIH0K
CiAgICBpZiAoIWVtcHR5KCRmaWxlbmFtZSkpIHsKCiAgICAgICAgJGNvcHkgPSAnPHNwYW4g
Y2xhc3M9ImNvcHktYXMiPjxsYWJlbCBmb3I9ImNvcHktZmlsZSI+Jy5nVHh0KCdzcGZfY29w
eV9maWxlJykuJzwvbGFiZWw+Jy5zcC5mSW5wdXQoJ3RleHQnLCAnbmV3bmFtZScsICcnLCAn
ZWRpdCcsICcnLCAnJywgJycsICcnLCAnY29weS1maWxlJykuc3AuCiAgICAgICAgICAgIGZJ
bnB1dCgnc3VibWl0JywgJ2NvcHknLCBnVHh0KCdjb3B5JyksICdzbWFsbGVyYm94JykuJzwv
c3Bhbj4nOwoKICAgIH0gZWxzZSB7CgogICAgICAgICRjb3B5ID0gJyc7CgogICAgfQoKICAg
ICRyaWdodCA9CiAgICAnPGRpdiBpZD0iY29udGVudF9zd2l0Y2hlciI+Jy4KICAgIGhlZChn
VHh0KCdzcGZfYWxsX2ZpbGVzJyksMikuCiAgICBncmFmKHNMaW5rKCdzcGZfZXh0JywgJ3Bv
dXInLCBnVHh0KCdzcGZfY3JlYXRlX25ld19maWxlJykpLCAnIGNsYXNzPSJhY3Rpb24tY3Jl
YXRlIicpLgogICAgc3BmX2V4dF9saXN0KCRmaWxlbmFtZSkuCiAgICAnPC9kaXY+JzsKCiAg
ICBlY2hvCiAgICAnPGgxIGNsYXNzPSJ0eHAtaGVhZGluZyI+Jy5nVHh0KCdzcGZfZXh0X2Zp
bGVzJykuJzwvaDE+Jy4KICAgICc8ZGl2IGlkPSInLiRldmVudC4nX2NvbnRhaW5lciIgY2xh
c3M9InR4cC1jb250YWluZXIiPicuCiAgICBzdGFydFRhYmxlKCcnLCAnJywgJ3R4cC1jb2x1
bW50YWJsZScpLgogICAgdHIoCiAgICAgICAgdGQoCiAgICAgICAgICAgIGZvcm0oCiAgICAg
ICAgICAgICAgICAnPGRpdiBpZD0ibWFpbl9jb250ZW50Ij4nLgogICAgICAgICAgICAgICAg
JGJ1dHRvbnMuCiAgICAgICAgICAgICAgICAnPHRleHRhcmVhIGlkPSJzcGZfZXh0IiBjbGFz
cz0iY29kZSIgbmFtZT0ic3BmX2V4dCIgY29scz0iJy5JTlBVVF9MQVJHRS4nIiByb3dzPSIn
LklOUFVUX1JFR1VMQVIuJyIgc3R5bGU9ImhlaWdodDogMzkuMjVlbTsiPicudHhwc3BlY2lh
bGNoYXJzKCRmaWxlY29udGVudCkuJzwvdGV4dGFyZWE+Jy4KICAgICAgICAgICAgICAgICc8
cD4nLmZJbnB1dCgnc3VibWl0JywnJyxnVHh0KCdzYXZlJyksJ3B1Ymxpc2gnKS4KICAgICAg
ICAgICAgICAgIGVJbnB1dCgnc3BmX2pzJykuc0lucHV0KCdzcGZfanNfc2F2ZScpLgogICAg
ICAgICAgICAgICAgaElucHV0KCdmaWxlbmFtZScsJGZpbGVuYW1lKS4nPC9wPicKICAgICAg
ICAgICAgICAgIC4kY29weS4KICAgICAgICAgICAgICAgICc8L2Rpdj4nCiAgICAgICAgICAg
ICwgJycsICcnLCAncG9zdCcsICdlZGl0LWZvcm0nLCAnJywgJ3N0eWxlX2Zvcm0nKQogICAg
ICAgICwgJycsICdjb2x1bW4nKS4KICAgICAgICB0ZHRsKAogICAgICAgICAgICAkcmlnaHQK
ICAgICAgICAsICcgY2xhc3M9ImNvbHVtbiInKQogICAgKS4KICAgIGVuZFRhYmxlKCkuCiAg
ICAnPC9kaXY+JzsKfQoKLyoqCiAqIENvcHkgZnVuY3Rpb24KICoKICovCgpmdW5jdGlvbiBz
cGZfZXh0X2NvcHkoKSB7CgogICAgZXh0cmFjdChncHNhKGFycmF5KCdvbGRuYW1lJywgJ25l
d25hbWUnKSkpOwoKICAgICRjb250ZW50ID0gZG9TbGFzaChmZXRjaCgnY29udGVudCcsICdz
cGZfZXh0JywgJ2ZpbGVuYW1lJywgJG9sZG5hbWUpKTsKCiAgICAkcnMgPSBzYWZlX2luc2Vy
dCgnc3BmX2V4dCcsICJjb250ZW50ID0gJyRjb250ZW50JywgZmlsZW5hbWUgPSAnIi5kb1Ns
YXNoKCRuZXduYW1lKS4iJyIpOwoKICAgIHNwZl9leHRfZWRpdCgKICAgICAgICBnVHh0KCdz
cGZfZmlsZV9jcmVhdGVkJywgYXJyYXkoJ3tuYW1lfScgPT4gJG5ld25hbWUpKQogICAgKTsK
fQoKLyoqCiAqIFNhdmUgZnVuY3Rpb24KICovCgpmdW5jdGlvbiBzcGZfZXh0X3NhdmUoKSB7
CgogICAgZXh0cmFjdChncHNhKGFycmF5KCdmaWxlbmFtZScsJ3NwZl9leHQnLCdzYXZlbmV3
JywnbmV3bmFtZScsJ2NvcHknKSkpOwogICAgJGNvbnRlbnQgPSBkb1NsYXNoKCRzcGZfZXh0
KTsKCiAgICBpZiAoJHNhdmVuZXcgb3IgJGNvcHkpIHsKCiAgICAgICAgJG5ld25hbWUgPSBk
b1NsYXNoKHRyaW0ocHJlZ19yZXBsYWNlKCcvWzw+JiJcJ10vJywgJycsIGdwcygnbmV3bmFt
ZScpKSkpOwoKICAgICAgICBpZiAoJG5ld25hbWUgYW5kIHNhZmVfZmllbGQoJ2ZpbGVuYW1l
JywgJ3NwZl9leHQnLCAiZmlsZW5hbWUgPSAnJG5ld25hbWUnIikpIHsKCiAgICAgICAgICAg
ICRtZXNzYWdlID0gZ1R4dCgnc3BmX2ZpbGVfZXhpc3RzJywgYXJyYXkoJ3tuYW1lfScgPT4g
JG5ld25hbWUpKTsKCiAgICAgICAgICAgIGlmICgkc2F2ZW5ldykgewoKICAgICAgICAgICAg
ICAgICRfUE9TVFsnbmV3bmFtZSddID0gJyc7CgogICAgICAgICAgICB9CgogICAgICAgIH0g
ZWxzZWlmICgkbmV3bmFtZSkgewoKICAgICAgICAgICAgc2FmZV9pbnNlcnQoJ3NwZl9leHQn
LCAiZmlsZW5hbWUgPSAnIi4kbmV3bmFtZS4iJywgY29udGVudCA9ICckY29udGVudCciKTsK
CiAgICAgICAgICAgICRtZXNzYWdlID0gZ1R4dCgnc3BmX2ZpbGVfY3JlYXRlZCcsIGFycmF5
KCd7bmFtZX0nID0+ICRuZXduYW1lKSk7CgogICAgICAgICAgICBzcGZfZXh0X3dyaXRlKCk7
CgogICAgICAgIH0gZWxzZSB7CgogICAgICAgICAgICAkbWVzc2FnZSA9IGFycmF5KGdUeHQo
J3NwZl9maWxlX25hbWVfcmVxdWlyZWQnKSwgRV9FUlJPUik7CgogICAgICAgIH0KCiAgICAg
ICAgc3BmX2V4dF9lZGl0KCRtZXNzYWdlKTsKCiAgICB9IGVsc2UgewoKICAgICAgICBzYWZl
X3VwZGF0ZSgnc3BmX2V4dCcsICJjb250ZW50ID0gJyRjb250ZW50JyIsICJmaWxlbmFtZSA9
ICciLmRvU2xhc2goJGZpbGVuYW1lKS4iJyIpOwoKICAgICAgICAkbWVzc2FnZSA9IGdUeHQo
J3NwZl9maWxlX3VwZGF0ZWQnLCBhcnJheSgne25hbWV9JyA9PiAkZmlsZW5hbWUpKTsKCiAg
ICAgICAgc3BmX2V4dF93cml0ZSgpOwoKICAgICAgICBzcGZfZXh0X2VkaXQoJG1lc3NhZ2Up
OwoKICAgIH0KCn0KCi8qKgogKiBXcml0ZSBmdW5jdGlvbgogKi8KCmZ1bmN0aW9uIHNwZl9l
eHRfd3JpdGUoKSB7CgogICAgZ2xvYmFsICRwcmVmczsKICAgIGV4dHJhY3QoZ3BzYShhcnJh
eSgnZmlsZW5hbWUnLCdzcGZfZXh0Jywnc2F2ZW5ldycsJ25ld25hbWUnLCdjb3B5JykpKTsK
CiAgICAkZmlsZW5hbWUgPSAocHMoJ2NvcHknKSBvciBwcygnc2F2ZW5ldycpKSA/IHBzKCdu
ZXduYW1lJykgOiBwcygnZmlsZW5hbWUnKTsKICAgICRmaWxlID0gJHByZWZzWydwYXRoX3Rv
X3NpdGUnXS4nLycuJHByZWZzWydzcGZfZXh0X2RpciddLicvJy5zYW5pdGl6ZUZvckZpbGUo
JGZpbGVuYW1lKTsKCiAgICBpZiAoZW1wdHkoJHByZWZzWydzcGZfZXh0X2RpciddKSBvciAh
JGZpbGVuYW1lKSB7CgogICAgICAgIHJldHVybjsKCiAgICB9IGVsc2UgewoKICAgICRjb250
ZW50X3JhdyA9IGZldGNoKCJjb250ZW50IiwgInNwZl9leHQiLCAnZmlsZW5hbWUnLCAkZmls
ZW5hbWUpOyAvLyBNb3ZlZCBoZXJlIHRvIHNhdmUgbmV3bHktY3JlYXRlZCBmaWxlcwoKICAg
ICAgICAkaGFuZGxlID0gZm9wZW4oJGZpbGUsICd3YicpOwogICAgICAgIGZ3cml0ZSgkaGFu
ZGxlLCAkY29udGVudF9yYXcpOwogICAgICAgIGZjbG9zZSgkaGFuZGxlKTsKICAgICAgICBj
aG1vZCgkZmlsZSwgMDY0NCk7CiAgICB9Cgp9CgovKioKICogRGVsZXRlIGZ1bmN0aW9uCiAq
LwoKZnVuY3Rpb24gc3BmX2V4dF9kZWxldGUoKSB7CgogICAgZ2xvYmFsICRwcmVmczsKCiAg
ICAkZmlsZW5hbWUgPSBwcygnZmlsZW5hbWUnKTsKICAgICRmaWxlID0gJHByZWZzWydwYXRo
X3RvX3NpdGUnXS4nLycuJHByZWZzWydzcGZfZXh0X2RpciddLicvJy4kZmlsZW5hbWU7Cgog
ICAgICAgIGlmICghZW1wdHkoJHByZWZzWydzcGZfZXh0X2RpciddKSBhbmQgJGZpbGVuYW1l
KSB7CgogICAgICAgICAgICBzYWZlX2RlbGV0ZSgnc3BmX2V4dCcsICJmaWxlbmFtZSA9ICci
LmRvU2xhc2goJGZpbGVuYW1lKS4iJyIpOwoKICAgICAgICAgICAgQHVubGluaygkZmlsZSk7
CgogICAgICAgIHNwZl9leHRfZWRpdCgKCiAgICAgICAgICAgIGdUeHQoJ3NwZl9maWxlX2Rl
bGV0ZWQnLCBhcnJheSgne25hbWV9JyA9PiAkZmlsZW5hbWUpKQogICAgICAgICk7CgogICAg
fSBlbHNlIHsKICAgICAgICByZXR1cm47CiAgICB9Cgp9IjtzOjM6Im1kNSI7czozMjoiZTE2
ZTIzNjMwN2E4OThlZDdiMmFhZmM2NWU2MThmYTYiO30=